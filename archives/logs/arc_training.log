Using Python: Python 3.10.12

========================================
ARC Llama Experiment
========================================
Model: Llama-3.2-1B-Instruct
Dataset: ARC-Easy (AI2 Reasoning Challenge)
Methods: LoRA-Attention, LoRA-All, Full Fine-Tuning
Training: 5 epochs (early stopping patience=2)
Total experiments: 3 (estimated time: 30-45 minutes)

========================================
Experiment 1/3: llama-arc-lora-attention
========================================
Model: meta-llama/Llama-3.2-1B-Instruct
Dataset: allenai/ai2_arc (ARC-Easy)
Method: lora-attention
Max seq length: 512
Output: ./results/llama-arc-lora-attention

Training samples: 2251
Validation samples: 200
Map:   0%|          | 0/2251 [00:00<?, ? examples/s]Map: 100%|██████████| 2251/2251 [00:00<00:00, 30900.33 examples/s]
Map:   0%|          | 0/200 [00:00<?, ? examples/s]Map: 100%|██████████| 200/200 [00:00<00:00, 25856.45 examples/s]
/home/wayneleo8/lora_without_regret/sft_compare.py:222: FutureWarning: `tokenizer` is deprecated and removed starting from version 0.16.0 for `SFTTrainer.__init__`. Use `processing_class` instead.
  trainer = SFTTrainer(
Converting train dataset to ChatML:   0%|          | 0/2251 [00:00<?, ? examples/s]Converting train dataset to ChatML: 100%|██████████| 2251/2251 [00:00<00:00, 51602.66 examples/s]
Applying chat template to train dataset:   0%|          | 0/2251 [00:00<?, ? examples/s]Applying chat template to train dataset:  70%|███████   | 1577/2251 [00:00<00:00, 15704.94 examples/s]Applying chat template to train dataset: 100%|██████████| 2251/2251 [00:00<00:00, 15950.24 examples/s]
Tokenizing train dataset:   0%|          | 0/2251 [00:00<?, ? examples/s]Tokenizing train dataset:  32%|███▏      | 710/2251 [00:00<00:00, 7067.10 examples/s]Tokenizing train dataset:  76%|███████▋  | 1717/2251 [00:00<00:00, 6655.88 examples/s]Tokenizing train dataset: 100%|██████████| 2251/2251 [00:00<00:00, 6504.28 examples/s]
Packing train dataset:   0%|          | 0/2251 [00:00<?, ? examples/s]Packing train dataset:  44%|████▍     | 1000/2251 [00:00<00:00, 7192.30 examples/s]Packing train dataset:  89%|████████▉ | 2000/2251 [00:00<00:00, 7581.72 examples/s]Packing train dataset: 100%|██████████| 2251/2251 [00:00<00:00, 8109.06 examples/s]
Converting eval dataset to ChatML:   0%|          | 0/200 [00:00<?, ? examples/s]Converting eval dataset to ChatML: 100%|██████████| 200/200 [00:00<00:00, 36575.57 examples/s]
Applying chat template to eval dataset:   0%|          | 0/200 [00:00<?, ? examples/s]Applying chat template to eval dataset: 100%|██████████| 200/200 [00:00<00:00, 15027.69 examples/s]
Tokenizing eval dataset:   0%|          | 0/200 [00:00<?, ? examples/s]Tokenizing eval dataset: 100%|██████████| 200/200 [00:00<00:00, 6032.80 examples/s]
Packing eval dataset:   0%|          | 0/200 [00:00<?, ? examples/s]Packing eval dataset: 100%|██████████| 200/200 [00:00<00:00, 21939.03 examples/s]
The model is already on multiple devices. Skipping the move to device specified in `args`.
The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'eos_token_id': 128009, 'pad_token_id': 128009}.
wandb: Using wandb-core as the SDK backend. Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: waynehacking8 (waynehacking8-national-taiwan-university-of-science-and-). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.18.3
wandb: Run data is saved locally in /home/wayneleo8/lora_without_regret/wandb/run-20251012_154252-l3gvu6b9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run bright-glade-40
wandb: ⭐️ View project at https://wandb.ai/waynehacking8-national-taiwan-university-of-science-and-/huggingface
wandb: 🚀 View run at https://wandb.ai/waynehacking8-national-taiwan-university-of-science-and-/huggingface/runs/l3gvu6b9

============================================================
Training Configuration:
  Method: LORA-ATTENTION
  Learning Rate: 0.0002
  Epochs: 5
  Early Stopping Patience: 2 epochs
  Batch Size: 1 x 4 = 4
============================================================

  0%|          | 0/545 [00:00<?, ?it/s]  0%|          | 1/545 [00:00<04:02,  2.25it/s]  0%|          | 2/545 [00:00<02:54,  3.11it/s]  1%|          | 3/545 [00:00<02:32,  3.55it/s]  1%|          | 4/545 [00:01<02:22,  3.80it/s]  1%|          | 5/545 [00:01<02:16,  3.95it/s]  1%|          | 6/545 [00:01<02:13,  4.04it/s]  1%|▏         | 7/545 [00:01<02:10,  4.12it/s]  1%|▏         | 8/545 [00:02<02:09,  4.15it/s]  2%|▏         | 9/545 [00:02<02:07,  4.21it/s]  2%|▏         | 10/545 [00:02<02:06,  4.24it/s]                                                  2%|▏         | 10/545 [00:02<02:06,  4.24it/s]  2%|▏         | 11/545 [00:02<02:05,  4.24it/s]  2%|▏         | 12/545 [00:03<02:05,  4.25it/s]  2%|▏         | 13/545 [00:03<02:05,  4.24it/s]  3%|▎         | 14/545 [00:03<02:04,  4.26it/s]  3%|▎         | 15/545 [00:03<02:04,  4.24it/s]  3%|▎         | 16/545 [00:03<02:04,  4.24it/s]  3%|▎         | 17/545 [00:04<02:04,  4.23it/s]  3%|▎         | 18/545 [00:04<02:03,  4.26it/s]  3%|▎         | 19/545 [00:04<02:02,  4.29it/s]  4%|▎         | 20/545 [00:04<02:01,  4.30it/s]                                                  4%|▎         | 20/545 [00:04<02:01,  4.30it/s]  4%|▍         | 21/545 [00:05<02:01,  4.31it/s]  4%|▍         | 22/545 [00:05<02:01,  4.31it/s]  4%|▍         | 23/545 [00:05<02:00,  4.32it/s]  4%|▍         | 24/545 [00:05<02:00,  4.33it/s]  5%|▍         | 25/545 [00:06<02:00,  4.30it/s]  5%|▍         | 26/545 [00:06<02:01,  4.29it/s]  5%|▍         | 27/545 [00:06<02:01,  4.25it/s]  5%|▌         | 28/545 [00:06<02:01,  4.25it/s]  5%|▌         | 29/545 [00:06<02:01,  4.25it/s]  6%|▌         | 30/545 [00:07<02:01,  4.23it/s]                                                  6%|▌         | 30/545 [00:07<02:01,  4.23it/s]  6%|▌         | 31/545 [00:07<02:00,  4.26it/s]  6%|▌         | 32/545 [00:07<02:00,  4.26it/s]  6%|▌         | 33/545 [00:07<01:59,  4.28it/s]  6%|▌         | 34/545 [00:08<02:00,  4.26it/s]  6%|▋         | 35/545 [00:08<02:00,  4.25it/s]  7%|▋         | 36/545 [00:08<01:59,  4.26it/s]  7%|▋         | 37/545 [00:08<01:58,  4.29it/s]  7%|▋         | 38/545 [00:09<01:58,  4.29it/s]  7%|▋         | 39/545 [00:09<01:57,  4.30it/s]  7%|▋         | 40/545 [00:09<01:56,  4.32it/s]                                                  7%|▋         | 40/545 [00:09<01:56,  4.32it/s]  8%|▊         | 41/545 [00:09<01:57,  4.29it/s]  8%|▊         | 42/545 [00:10<01:56,  4.30it/s]  8%|▊         | 43/545 [00:10<01:56,  4.31it/s]  8%|▊         | 44/545 [00:10<01:55,  4.32it/s]  8%|▊         | 45/545 [00:10<01:55,  4.33it/s]  8%|▊         | 46/545 [00:10<01:56,  4.30it/s]  9%|▊         | 47/545 [00:11<01:56,  4.28it/s]  9%|▉         | 48/545 [00:11<01:56,  4.27it/s]  9%|▉         | 49/545 [00:11<01:56,  4.26it/s]  9%|▉         | 50/545 [00:11<01:56,  4.24it/s]                                                  9%|▉         | 50/545 [00:11<01:56,  4.24it/s]  9%|▉         | 51/545 [00:12<01:57,  4.21it/s] 10%|▉         | 52/545 [00:12<01:56,  4.22it/s] 10%|▉         | 53/545 [00:12<01:55,  4.26it/s] 10%|▉         | 54/545 [00:12<01:54,  4.28it/s] 10%|█         | 55/545 [00:13<01:54,  4.29it/s] 10%|█         | 56/545 [00:13<01:53,  4.31it/s] 10%|█         | 57/545 [00:13<01:53,  4.30it/s] 11%|█         | 58/545 [00:13<01:53,  4.30it/s] 11%|█         | 59/545 [00:14<01:52,  4.31it/s] 11%|█         | 60/545 [00:14<01:52,  4.31it/s]                                                 11%|█         | 60/545 [00:14<01:52,  4.31it/s] 11%|█         | 61/545 [00:14<01:52,  4.31it/s] 11%|█▏        | 62/545 [00:14<01:52,  4.30it/s] 12%|█▏        | 63/545 [00:14<01:51,  4.31it/s] 12%|█▏        | 64/545 [00:15<01:51,  4.30it/s] 12%|█▏        | 65/545 [00:15<01:53,  4.24it/s] 12%|█▏        | 66/545 [00:15<01:53,  4.23it/s] 12%|█▏        | 67/545 [00:15<01:53,  4.21it/s] 12%|█▏        | 68/545 [00:16<01:54,  4.18it/s] 13%|█▎        | 69/545 [00:16<01:55,  4.13it/s] 13%|█▎        | 70/545 [00:16<01:55,  4.12it/s]                                                 13%|█▎        | 70/545 [00:16<01:55,  4.12it/s] 13%|█▎        | 71/545 [00:16<01:54,  4.16it/s] 13%|█▎        | 72/545 [00:17<01:53,  4.18it/s] 13%|█▎        | 73/545 [00:17<01:52,  4.21it/s] 14%|█▎        | 74/545 [00:17<01:51,  4.21it/s] 14%|█▍        | 75/545 [00:17<01:52,  4.19it/s] 14%|█▍        | 76/545 [00:18<01:52,  4.17it/s] 14%|█▍        | 77/545 [00:18<01:52,  4.15it/s] 14%|█▍        | 78/545 [00:18<01:53,  4.13it/s] 14%|█▍        | 79/545 [00:18<01:51,  4.18it/s] 15%|█▍        | 80/545 [00:19<01:50,  4.21it/s]                                                 15%|█▍        | 80/545 [00:19<01:50,  4.21it/s] 15%|█▍        | 81/545 [00:19<01:50,  4.19it/s] 15%|█▌        | 82/545 [00:19<01:51,  4.17it/s] 15%|█▌        | 83/545 [00:19<01:51,  4.13it/s] 15%|█▌        | 84/545 [00:19<01:51,  4.13it/s] 16%|█▌        | 85/545 [00:20<01:51,  4.13it/s] 16%|█▌        | 86/545 [00:20<01:50,  4.16it/s] 16%|█▌        | 87/545 [00:20<01:49,  4.17it/s] 16%|█▌        | 88/545 [00:20<01:48,  4.21it/s] 16%|█▋        | 89/545 [00:21<01:48,  4.22it/s] 17%|█▋        | 90/545 [00:21<01:48,  4.19it/s]                                                 17%|█▋        | 90/545 [00:21<01:48,  4.19it/s] 17%|█▋        | 91/545 [00:21<01:48,  4.17it/s] 17%|█▋        | 92/545 [00:21<01:49,  4.13it/s] 17%|█▋        | 93/545 [00:22<01:49,  4.13it/s] 17%|█▋        | 94/545 [00:22<01:49,  4.14it/s] 17%|█▋        | 95/545 [00:22<01:48,  4.14it/s] 18%|█▊        | 96/545 [00:22<01:48,  4.15it/s] 18%|█▊        | 97/545 [00:23<01:47,  4.15it/s] 18%|█▊        | 98/545 [00:23<01:48,  4.14it/s] 18%|█▊        | 99/545 [00:23<01:47,  4.14it/s] 18%|█▊        | 100/545 [00:23<01:48,  4.12it/s]                                                  18%|█▊        | 100/545 [00:23<01:48,  4.12it/s] 19%|█▊        | 101/545 [00:24<01:48,  4.09it/s] 19%|█▊        | 102/545 [00:24<01:48,  4.07it/s] 19%|█▉        | 103/545 [00:24<01:48,  4.07it/s] 19%|█▉        | 104/545 [00:24<01:48,  4.07it/s] 19%|█▉        | 105/545 [00:25<01:48,  4.07it/s] 19%|█▉        | 106/545 [00:25<01:47,  4.09it/s] 20%|█▉        | 107/545 [00:25<01:47,  4.09it/s] 20%|█▉        | 108/545 [00:25<01:46,  4.10it/s] 20%|██        | 109/545 [00:26<01:46,  4.09it/s]{'loss': 2.2234, 'grad_norm': 0.25844818353652954, 'learning_rate': 0.00019669724770642204, 'mean_token_accuracy': 0.653852578997612, 'epoch': 0.09}
{'loss': 1.6636, 'grad_norm': 0.17655707895755768, 'learning_rate': 0.00019302752293577982, 'mean_token_accuracy': 0.7071739464998246, 'epoch': 0.18}
{'loss': 1.4406, 'grad_norm': 0.12150530517101288, 'learning_rate': 0.00018935779816513763, 'mean_token_accuracy': 0.7399944081902504, 'epoch': 0.28}
{'loss': 1.3684, 'grad_norm': 0.10295666009187698, 'learning_rate': 0.00018568807339449544, 'mean_token_accuracy': 0.747847692668438, 'epoch': 0.37}
{'loss': 1.3756, 'grad_norm': 0.10562223196029663, 'learning_rate': 0.00018201834862385322, 'mean_token_accuracy': 0.7437685430049896, 'epoch': 0.46}
{'loss': 1.3966, 'grad_norm': 0.10614034533500671, 'learning_rate': 0.00017834862385321103, 'mean_token_accuracy': 0.7430015176534652, 'epoch': 0.55}
{'loss': 1.3209, 'grad_norm': 0.09928815811872482, 'learning_rate': 0.00017467889908256884, 'mean_token_accuracy': 0.7559867084026337, 'epoch': 0.64}
{'loss': 1.3412, 'grad_norm': 0.1081664189696312, 'learning_rate': 0.00017100917431192662, 'mean_token_accuracy': 0.7467822015285492, 'epoch': 0.73}
{'loss': 1.2654, 'grad_norm': 0.38813936710357666, 'learning_rate': 0.00016733944954128442, 'mean_token_accuracy': 0.7587912321090698, 'epoch': 0.83}
{'loss': 1.1987, 'grad_norm': 0.123550646007061, 'learning_rate': 0.00016366972477064223, 'mean_token_accuracy': 0.7682897731661796, 'epoch': 0.92}

  0%|          | 0/39 [00:00<?, ?it/s][A
 13%|█▎        | 5/39 [00:00<00:00, 46.43it/s][A
 26%|██▌       | 10/39 [00:00<00:00, 40.00it/s][A
 38%|███▊      | 15/39 [00:00<00:00, 38.45it/s][A
 49%|████▊     | 19/39 [00:00<00:00, 37.82it/s][A
 59%|█████▉    | 23/39 [00:00<00:00, 37.59it/s][A
 69%|██████▉   | 27/39 [00:00<00:00, 37.40it/s][A
 79%|███████▉  | 31/39 [00:00<00:00, 37.25it/s][A
 90%|████████▉ | 35/39 [00:00<00:00, 36.92it/s][A                                                 
                                               [A 20%|██        | 109/545 [00:27<01:46,  4.09it/s]
100%|██████████| 39/39 [00:01<00:00, 36.92it/s][A
                                               [A 20%|██        | 110/545 [00:28<06:07,  1.18it/s]                                                  20%|██        | 110/545 [00:28<06:07,  1.18it/s] 20%|██        | 111/545 [00:28<04:48,  1.50it/s] 21%|██        | 112/545 [00:28<03:52,  1.86it/s] 21%|██        | 113/545 [00:29<03:14,  2.22it/s] 21%|██        | 114/545 [00:29<02:47,  2.57it/s] 21%|██        | 115/545 [00:29<02:28,  2.89it/s] 21%|██▏       | 116/545 [00:29<02:15,  3.16it/s] 21%|██▏       | 117/545 [00:30<02:06,  3.38it/s] 22%|██▏       | 118/545 [00:30<01:59,  3.57it/s] 22%|██▏       | 119/545 [00:30<01:53,  3.77it/s] 22%|██▏       | 120/545 [00:30<01:48,  3.92it/s]                                                  22%|██▏       | 120/545 [00:30<01:48,  3.92it/s] 22%|██▏       | 121/545 [00:30<01:45,  4.03it/s] 22%|██▏       | 122/545 [00:31<01:42,  4.13it/s] 23%|██▎       | 123/545 [00:31<01:40,  4.19it/s] 23%|██▎       | 124/545 [00:31<01:39,  4.24it/s] 23%|██▎       | 125/545 [00:31<01:38,  4.27it/s] 23%|██▎       | 126/545 [00:32<01:37,  4.29it/s] 23%|██▎       | 127/545 [00:32<01:36,  4.31it/s] 23%|██▎       | 128/545 [00:32<01:36,  4.31it/s] 24%|██▎       | 129/545 [00:32<01:36,  4.33it/s] 24%|██▍       | 130/545 [00:33<01:35,  4.33it/s]                                                  24%|██▍       | 130/545 [00:33<01:35,  4.33it/s] 24%|██▍       | 131/545 [00:33<01:36,  4.29it/s] 24%|██▍       | 132/545 [00:33<01:37,  4.23it/s] 24%|██▍       | 133/545 [00:33<01:38,  4.18it/s] 25%|██▍       | 134/545 [00:33<01:39,  4.14it/s] 25%|██▍       | 135/545 [00:34<01:38,  4.16it/s] 25%|██▍       | 136/545 [00:34<01:37,  4.21it/s] 25%|██▌       | 137/545 [00:34<01:36,  4.23it/s] 25%|██▌       | 138/545 [00:34<01:35,  4.26it/s] 26%|██▌       | 139/545 [00:35<01:35,  4.24it/s] 26%|██▌       | 140/545 [00:35<01:35,  4.22it/s]                                                  26%|██▌       | 140/545 [00:35<01:35,  4.22it/s] 26%|██▌       | 141/545 [00:35<01:35,  4.21it/s] 26%|██▌       | 142/545 [00:35<01:35,  4.22it/s] 26%|██▌       | 143/545 [00:36<01:34,  4.24it/s] 26%|██▋       | 144/545 [00:36<01:34,  4.26it/s] 27%|██▋       | 145/545 [00:36<01:33,  4.28it/s] 27%|██▋       | 146/545 [00:36<01:32,  4.30it/s] 27%|██▋       | 147/545 [00:37<01:32,  4.32it/s] 27%|██▋       | 148/545 [00:37<01:31,  4.32it/s] 27%|██▋       | 149/545 [00:37<01:31,  4.33it/s] 28%|██▊       | 150/545 [00:37<01:31,  4.32it/s]                                                  28%|██▊       | 150/545 [00:37<01:31,  4.32it/s] 28%|██▊       | 151/545 [00:37<01:31,  4.32it/s] 28%|██▊       | 152/545 [00:38<01:30,  4.33it/s] 28%|██▊       | 153/545 [00:38<01:27,  4.47it/s] 28%|██▊       | 154/545 [00:38<01:28,  4.42it/s] 28%|██▊       | 155/545 [00:38<01:29,  4.38it/s] 29%|██▊       | 156/545 [00:39<01:29,  4.36it/s] 29%|██▉       | 157/545 [00:39<01:29,  4.33it/s] 29%|██▉       | 158/545 [00:39<01:29,  4.30it/s] 29%|██▉       | 159/545 [00:39<01:29,  4.30it/s] 29%|██▉       | 160/545 [00:40<01:29,  4.31it/s]                                                  29%|██▉       | 160/545 [00:40<01:29,  4.31it/s] 30%|██▉       | 161/545 [00:40<01:28,  4.32it/s] 30%|██▉       | 162/545 [00:40<01:29,  4.29it/s] 30%|██▉       | 163/545 [00:40<01:28,  4.30it/s] 30%|███       | 164/545 [00:40<01:28,  4.30it/s] 30%|███       | 165/545 [00:41<01:28,  4.30it/s] 30%|███       | 166/545 [00:41<01:28,  4.30it/s] 31%|███       | 167/545 [00:41<01:27,  4.30it/s] 31%|███       | 168/545 [00:41<01:27,  4.31it/s] 31%|███       | 169/545 [00:42<01:27,  4.31it/s] 31%|███       | 170/545 [00:42<01:26,  4.32it/s]                                                  31%|███       | 170/545 [00:42<01:26,  4.32it/s] 31%|███▏      | 171/545 [00:42<01:26,  4.32it/s] 32%|███▏      | 172/545 [00:42<01:26,  4.29it/s] 32%|███▏      | 173/545 [00:43<01:27,  4.24it/s] 32%|███▏      | 174/545 [00:43<01:28,  4.21it/s] 32%|███▏      | 175/545 [00:43<01:27,  4.23it/s] 32%|███▏      | 176/545 [00:43<01:26,  4.26it/s] 32%|███▏      | 177/545 [00:43<01:25,  4.28it/s] 33%|███▎      | 178/545 [00:44<01:25,  4.30it/s] 33%|███▎      | 179/545 [00:44<01:24,  4.31it/s] 33%|███▎      | 180/545 [00:44<01:25,  4.26it/s]                                                  33%|███▎      | 180/545 [00:44<01:25,  4.26it/s] 33%|███▎      | 181/545 [00:44<01:26,  4.20it/s] 33%|███▎      | 182/545 [00:45<01:27,  4.15it/s] 34%|███▎      | 183/545 [00:45<01:27,  4.14it/s] 34%|███▍      | 184/545 [00:45<01:26,  4.17it/s] 34%|███▍      | 185/545 [00:45<01:25,  4.21it/s] 34%|███▍      | 186/545 [00:46<01:25,  4.19it/s] 34%|███▍      | 187/545 [00:46<01:24,  4.23it/s] 34%|███▍      | 188/545 [00:46<01:24,  4.25it/s] 35%|███▍      | 189/545 [00:46<01:24,  4.19it/s] 35%|███▍      | 190/545 [00:47<01:25,  4.15it/s]                                                  35%|███▍      | 190/545 [00:47<01:25,  4.15it/s] 35%|███▌      | 191/545 [00:47<01:24,  4.17it/s] 35%|███▌      | 192/545 [00:47<01:23,  4.21it/s] 35%|███▌      | 193/545 [00:47<01:23,  4.23it/s] 36%|███▌      | 194/545 [00:48<01:22,  4.25it/s] 36%|███▌      | 195/545 [00:48<01:22,  4.23it/s] 36%|███▌      | 196/545 [00:48<01:22,  4.24it/s] 36%|███▌      | 197/545 [00:48<01:21,  4.24it/s] 36%|███▋      | 198/545 [00:48<01:21,  4.25it/s] 37%|███▋      | 199/545 [00:49<01:21,  4.26it/s] 37%|███▋      | 200/545 [00:49<01:21,  4.25it/s]                                                  37%|███▋      | 200/545 [00:49<01:21,  4.25it/s] 37%|███▋      | 201/545 [00:49<01:20,  4.27it/s] 37%|███▋      | 202/545 [00:49<01:20,  4.24it/s] 37%|███▋      | 203/545 [00:50<01:22,  4.12it/s] 37%|███▋      | 204/545 [00:50<01:21,  4.16it/s] 38%|███▊      | 205/545 [00:50<01:21,  4.20it/s] 38%|███▊      | 206/545 [00:50<01:20,  4.21it/s] 38%|███▊      | 207/545 [00:51<01:19,  4.24it/s] 38%|███▊      | 208/545 [00:51<01:19,  4.25it/s] 38%|███▊      | 209/545 [00:51<01:19,  4.24it/s] 39%|███▊      | 210/545 [00:51<01:19,  4.19it/s]                                                  39%|███▊      | 210/545 [00:51<01:19,  4.19it/s] 39%|███▊      | 211/545 [00:52<01:20,  4.13it/s] 39%|███▉      | 212/545 [00:52<01:19,  4.18it/s] 39%|███▉      | 213/545 [00:52<01:18,  4.22it/s] 39%|███▉      | 214/545 [00:52<01:18,  4.24it/s] 39%|███▉      | 215/545 [00:53<01:17,  4.26it/s] 40%|███▉      | 216/545 [00:53<01:17,  4.22it/s] 40%|███▉      | 217/545 [00:53<01:18,  4.16it/s] 40%|████      | 218/545 [00:53<01:18,  4.19it/s]{'eval_loss': 1.1338249444961548, 'eval_runtime': 1.051, 'eval_samples_per_second': 37.108, 'eval_steps_per_second': 37.108, 'eval_mean_token_accuracy': 0.7551622351010641, 'epoch': 1.0}
{'loss': 1.1752, 'grad_norm': 0.12228438258171082, 'learning_rate': 0.00016, 'mean_token_accuracy': 0.7719850838184357, 'epoch': 1.01}
{'loss': 1.0606, 'grad_norm': 0.1421152949333191, 'learning_rate': 0.00015633027522935782, 'mean_token_accuracy': 0.7690371185541153, 'epoch': 1.1}
{'loss': 1.069, 'grad_norm': 0.14487183094024658, 'learning_rate': 0.0001526605504587156, 'mean_token_accuracy': 0.7654106378555298, 'epoch': 1.19}
{'loss': 1.0575, 'grad_norm': 0.1619562804698944, 'learning_rate': 0.0001489908256880734, 'mean_token_accuracy': 0.7714899212121964, 'epoch': 1.28}
{'loss': 1.0498, 'grad_norm': 0.11323992908000946, 'learning_rate': 0.00014532110091743122, 'mean_token_accuracy': 0.7689092174172402, 'epoch': 1.38}
{'loss': 1.0493, 'grad_norm': 0.11172525584697723, 'learning_rate': 0.000141651376146789, 'mean_token_accuracy': 0.7696683093905449, 'epoch': 1.47}
{'loss': 1.0415, 'grad_norm': 0.14093808829784393, 'learning_rate': 0.0001379816513761468, 'mean_token_accuracy': 0.7717124670743942, 'epoch': 1.56}
{'loss': 1.0788, 'grad_norm': 0.11172541975975037, 'learning_rate': 0.00013431192660550461, 'mean_token_accuracy': 0.7636571317911148, 'epoch': 1.65}
{'loss': 1.0268, 'grad_norm': 0.11411448568105698, 'learning_rate': 0.0001306422018348624, 'mean_token_accuracy': 0.7723117858171463, 'epoch': 1.74}
{'loss': 1.0213, 'grad_norm': 0.11017035692930222, 'learning_rate': 0.0001269724770642202, 'mean_token_accuracy': 0.7739963948726654, 'epoch': 1.83}
{'loss': 1.0188, 'grad_norm': 0.12461026757955551, 'learning_rate': 0.00012330275229357798, 'mean_token_accuracy': 0.7766967788338661, 'epoch': 1.93}

  0%|          | 0/39 [00:00<?, ?it/s][A
 13%|█▎        | 5/39 [00:00<00:00, 49.32it/s][A
 26%|██▌       | 10/39 [00:00<00:00, 42.81it/s][A
 38%|███▊      | 15/39 [00:00<00:00, 41.32it/s][A
 51%|█████▏    | 20/39 [00:00<00:00, 40.57it/s][A
 64%|██████▍   | 25/39 [00:00<00:00, 40.25it/s][A
 77%|███████▋  | 30/39 [00:00<00:00, 40.01it/s][A
 90%|████████▉ | 35/39 [00:00<00:00, 39.83it/s][A                                                 
                                               [A 40%|████      | 218/545 [00:54<01:18,  4.19it/s]
100%|██████████| 39/39 [00:00<00:00, 39.83it/s][A
                                               [A 40%|████      | 219/545 [00:55<04:20,  1.25it/s] 40%|████      | 220/545 [00:56<03:24,  1.59it/s]                                                  40%|████      | 220/545 [00:56<03:24,  1.59it/s] 41%|████      | 221/545 [00:56<02:45,  1.96it/s] 41%|████      | 222/545 [00:56<02:17,  2.35it/s] 41%|████      | 223/545 [00:56<01:59,  2.69it/s] 41%|████      | 224/545 [00:57<01:45,  3.03it/s] 41%|████▏     | 225/545 [00:57<01:36,  3.33it/s] 41%|████▏     | 226/545 [00:57<01:29,  3.58it/s] 42%|████▏     | 227/545 [00:57<01:24,  3.78it/s] 42%|████▏     | 228/545 [00:57<01:21,  3.89it/s] 42%|████▏     | 229/545 [00:58<01:19,  3.99it/s] 42%|████▏     | 230/545 [00:58<01:17,  4.07it/s]                                                  42%|████▏     | 230/545 [00:58<01:17,  4.07it/s] 42%|████▏     | 231/545 [00:58<01:16,  4.13it/s] 43%|████▎     | 232/545 [00:58<01:17,  4.05it/s] 43%|████▎     | 233/545 [00:59<01:16,  4.10it/s] 43%|████▎     | 234/545 [00:59<01:16,  4.05it/s] 43%|████▎     | 235/545 [00:59<01:15,  4.10it/s] 43%|████▎     | 236/545 [00:59<01:15,  4.09it/s] 43%|████▎     | 237/545 [01:00<01:14,  4.12it/s] 44%|████▎     | 238/545 [01:00<01:13,  4.18it/s] 44%|████▍     | 239/545 [01:00<01:12,  4.21it/s] 44%|████▍     | 240/545 [01:00<01:12,  4.22it/s]                                                  44%|████▍     | 240/545 [01:00<01:12,  4.22it/s] 44%|████▍     | 241/545 [01:01<01:12,  4.17it/s] 44%|████▍     | 242/545 [01:01<01:27,  3.45it/s] 45%|████▍     | 243/545 [01:01<01:39,  3.04it/s] 45%|████▍     | 244/545 [01:02<01:50,  2.72it/s] 45%|████▍     | 245/545 [01:02<01:58,  2.53it/s] 45%|████▌     | 246/545 [01:03<02:03,  2.41it/s] 45%|████▌     | 247/545 [01:03<02:07,  2.34it/s] 46%|████▌     | 248/545 [01:04<02:10,  2.28it/s] 46%|████▌     | 249/545 [01:04<02:11,  2.24it/s] 46%|████▌     | 250/545 [01:05<02:13,  2.22it/s]                                                  46%|████▌     | 250/545 [01:05<02:13,  2.22it/s] 46%|████▌     | 251/545 [01:05<02:13,  2.20it/s] 46%|████▌     | 252/545 [01:06<02:14,  2.19it/s] 46%|████▋     | 253/545 [01:06<02:14,  2.18it/s] 47%|████▋     | 254/545 [01:06<02:14,  2.17it/s] 47%|████▋     | 255/545 [01:07<02:14,  2.16it/s] 47%|████▋     | 256/545 [01:07<02:14,  2.16it/s] 47%|████▋     | 257/545 [01:08<02:13,  2.16it/s] 47%|████▋     | 258/545 [01:08<02:12,  2.17it/s] 48%|████▊     | 259/545 [01:09<02:11,  2.17it/s] 48%|████▊     | 260/545 [01:09<02:11,  2.18it/s]                                                  48%|████▊     | 260/545 [01:09<02:11,  2.18it/s] 48%|████▊     | 261/545 [01:10<02:10,  2.18it/s] 48%|████▊     | 262/545 [01:10<02:10,  2.17it/s] 48%|████▊     | 263/545 [01:11<02:09,  2.17it/s] 48%|████▊     | 264/545 [01:11<02:10,  2.16it/s] 49%|████▊     | 265/545 [01:12<02:09,  2.15it/s] 49%|████▉     | 266/545 [01:12<02:09,  2.15it/s] 49%|████▉     | 267/545 [01:12<02:09,  2.15it/s] 49%|████▉     | 268/545 [01:13<02:08,  2.15it/s] 49%|████▉     | 269/545 [01:13<02:07,  2.16it/s] 50%|████▉     | 270/545 [01:14<02:06,  2.17it/s]                                                  50%|████▉     | 270/545 [01:14<02:06,  2.17it/s] 50%|████▉     | 271/545 [01:14<02:06,  2.17it/s] 50%|████▉     | 272/545 [01:15<02:05,  2.17it/s] 50%|█████     | 273/545 [01:15<02:05,  2.17it/s] 50%|█████     | 274/545 [01:16<02:04,  2.17it/s] 50%|█████     | 275/545 [01:16<02:04,  2.17it/s] 51%|█████     | 276/545 [01:17<02:03,  2.17it/s] 51%|█████     | 277/545 [01:17<02:03,  2.17it/s] 51%|█████     | 278/545 [01:18<02:02,  2.17it/s] 51%|█████     | 279/545 [01:18<02:02,  2.17it/s] 51%|█████▏    | 280/545 [01:18<02:01,  2.17it/s]                                                  51%|█████▏    | 280/545 [01:18<02:01,  2.17it/s] 52%|█████▏    | 281/545 [01:19<02:01,  2.17it/s] 52%|█████▏    | 282/545 [01:19<02:01,  2.17it/s] 52%|█████▏    | 283/545 [01:20<02:00,  2.17it/s] 52%|█████▏    | 284/545 [01:20<02:00,  2.17it/s] 52%|█████▏    | 285/545 [01:21<01:59,  2.17it/s] 52%|█████▏    | 286/545 [01:21<01:59,  2.17it/s] 53%|█████▎    | 287/545 [01:22<01:58,  2.17it/s] 53%|█████▎    | 288/545 [01:22<01:58,  2.17it/s] 53%|█████▎    | 289/545 [01:23<01:57,  2.17it/s] 53%|█████▎    | 290/545 [01:23<01:57,  2.17it/s]                                                  53%|█████▎    | 290/545 [01:23<01:57,  2.17it/s] 53%|█████▎    | 291/545 [01:24<01:56,  2.17it/s] 54%|█████▎    | 292/545 [01:24<01:56,  2.17it/s] 54%|█████▍    | 293/545 [01:24<01:56,  2.17it/s] 54%|█████▍    | 294/545 [01:25<01:55,  2.17it/s] 54%|█████▍    | 295/545 [01:25<01:55,  2.17it/s] 54%|█████▍    | 296/545 [01:26<01:54,  2.17it/s] 54%|█████▍    | 297/545 [01:26<01:54,  2.17it/s] 55%|█████▍    | 298/545 [01:27<01:53,  2.17it/s] 55%|█████▍    | 299/545 [01:27<01:53,  2.17it/s] 55%|█████▌    | 300/545 [01:28<01:52,  2.17it/s]                                                  55%|█████▌    | 300/545 [01:28<01:52,  2.17it/s] 55%|█████▌    | 301/545 [01:28<01:52,  2.17it/s] 55%|█████▌    | 302/545 [01:29<01:52,  2.17it/s] 56%|█████▌    | 303/545 [01:29<01:51,  2.17it/s] 56%|█████▌    | 304/545 [01:30<01:51,  2.17it/s] 56%|█████▌    | 305/545 [01:30<01:50,  2.17it/s] 56%|█████▌    | 306/545 [01:30<01:50,  2.17it/s] 56%|█████▋    | 307/545 [01:31<01:49,  2.17it/s] 57%|█████▋    | 308/545 [01:31<01:49,  2.17it/s] 57%|█████▋    | 309/545 [01:32<01:48,  2.18it/s] 57%|█████▋    | 310/545 [01:32<01:47,  2.18it/s]                                                  57%|█████▋    | 310/545 [01:32<01:47,  2.18it/s] 57%|█████▋    | 311/545 [01:33<01:47,  2.17it/s] 57%|█████▋    | 312/545 [01:33<01:47,  2.17it/s] 57%|█████▋    | 313/545 [01:34<01:42,  2.25it/s] 58%|█████▊    | 314/545 [01:34<01:43,  2.24it/s] 58%|█████▊    | 315/545 [01:35<01:43,  2.22it/s] 58%|█████▊    | 316/545 [01:35<01:43,  2.20it/s] 58%|█████▊    | 317/545 [01:35<01:43,  2.19it/s] 58%|█████▊    | 318/545 [01:36<01:43,  2.18it/s] 59%|█████▊    | 319/545 [01:36<01:43,  2.18it/s] 59%|█████▊    | 320/545 [01:37<01:43,  2.17it/s]                                                  59%|█████▊    | 320/545 [01:37<01:43,  2.17it/s] 59%|█████▉    | 321/545 [01:37<01:43,  2.17it/s] 59%|█████▉    | 322/545 [01:38<01:42,  2.17it/s] 59%|█████▉    | 323/545 [01:38<01:42,  2.17it/s] 59%|█████▉    | 324/545 [01:39<01:41,  2.17it/s] 60%|█████▉    | 325/545 [01:39<01:41,  2.17it/s] 60%|█████▉    | 326/545 [01:40<01:40,  2.17it/s] 60%|██████    | 327/545 [01:40<01:40,  2.17it/s]{'eval_loss': 1.0652974843978882, 'eval_runtime': 0.9789, 'eval_samples_per_second': 39.84, 'eval_steps_per_second': 39.84, 'eval_mean_token_accuracy': 0.7646770074333943, 'epoch': 2.0}
{'loss': 1.0264, 'grad_norm': 0.10961716622114182, 'learning_rate': 0.00011963302752293579, 'mean_token_accuracy': 0.7778330445289612, 'epoch': 2.02}
{'loss': 0.9811, 'grad_norm': 0.10884068161249161, 'learning_rate': 0.00011596330275229359, 'mean_token_accuracy': 0.7804536685347557, 'epoch': 2.11}
{'loss': 1.0616, 'grad_norm': 0.126261904835701, 'learning_rate': 0.0001122935779816514, 'mean_token_accuracy': 0.7625639602541924, 'epoch': 2.2}
{'loss': 0.9873, 'grad_norm': 0.16815783083438873, 'learning_rate': 0.00010862385321100919, 'mean_token_accuracy': 0.7790796279907226, 'epoch': 2.29}
{'loss': 0.963, 'grad_norm': 0.11940573900938034, 'learning_rate': 0.00010495412844036698, 'mean_token_accuracy': 0.7811088666319848, 'epoch': 2.39}
{'loss': 1.0098, 'grad_norm': 0.1364082247018814, 'learning_rate': 0.00010128440366972478, 'mean_token_accuracy': 0.7763825803995132, 'epoch': 2.48}
{'loss': 1.0428, 'grad_norm': 0.13830749690532684, 'learning_rate': 9.761467889908259e-05, 'mean_token_accuracy': 0.7682994678616524, 'epoch': 2.57}
{'loss': 1.0168, 'grad_norm': 0.14133355021476746, 'learning_rate': 9.394495412844038e-05, 'mean_token_accuracy': 0.774325107038021, 'epoch': 2.66}
{'loss': 0.9991, 'grad_norm': 0.13733665645122528, 'learning_rate': 9.027522935779817e-05, 'mean_token_accuracy': 0.7791416391730308, 'epoch': 2.75}
{'loss': 0.979, 'grad_norm': 0.1359921395778656, 'learning_rate': 8.660550458715597e-05, 'mean_token_accuracy': 0.7801815286278725, 'epoch': 2.84}
{'loss': 1.0321, 'grad_norm': 0.1378442645072937, 'learning_rate': 8.293577981651378e-05, 'mean_token_accuracy': 0.7740726262331009, 'epoch': 2.94}

  0%|          | 0/39 [00:00<?, ?it/s][A
  8%|▊         | 3/39 [00:00<00:01, 26.24it/s][A
 15%|█▌        | 6/39 [00:00<00:01, 22.41it/s][A
 23%|██▎       | 9/39 [00:00<00:01, 20.56it/s][A
 31%|███       | 12/39 [00:00<00:01, 19.55it/s][A
 38%|███▊      | 15/39 [00:00<00:01, 20.09it/s][A
 46%|████▌     | 18/39 [00:00<00:01, 19.59it/s][A
 51%|█████▏    | 20/39 [00:00<00:00, 19.32it/s][A
 59%|█████▉    | 23/39 [00:01<00:00, 19.80it/s][A
 64%|██████▍   | 25/39 [00:01<00:00, 19.46it/s][A
 69%|██████▉   | 27/39 [00:01<00:00, 19.25it/s][A
 74%|███████▍  | 29/39 [00:01<00:00, 19.03it/s][A
 82%|████████▏ | 32/39 [00:01<00:00, 19.76it/s][A
 87%|████████▋ | 34/39 [00:01<00:00, 19.44it/s][A
 92%|█████████▏| 36/39 [00:01<00:00, 19.16it/s][A
 97%|█████████▋| 38/39 [00:01<00:00, 18.99it/s][A                                                 
                                               [A 60%|██████    | 327/545 [01:42<01:40,  2.17it/s]
100%|██████████| 39/39 [00:01<00:00, 18.99it/s][A
                                               [A 60%|██████    | 328/545 [01:43<04:51,  1.34s/it] 60%|██████    | 329/545 [01:44<03:52,  1.08s/it] 61%|██████    | 330/545 [01:44<03:11,  1.12it/s]                                                  61%|██████    | 330/545 [01:44<03:11,  1.12it/s] 61%|██████    | 331/545 [01:45<02:43,  1.31it/s] 61%|██████    | 332/545 [01:45<02:23,  1.49it/s] 61%|██████    | 333/545 [01:46<02:08,  1.65it/s] 61%|██████▏   | 334/545 [01:46<01:58,  1.78it/s] 61%|██████▏   | 335/545 [01:47<01:51,  1.88it/s] 62%|██████▏   | 336/545 [01:47<01:43,  2.03it/s] 62%|██████▏   | 337/545 [01:48<01:40,  2.08it/s] 62%|██████▏   | 338/545 [01:48<01:37,  2.11it/s] 62%|██████▏   | 339/545 [01:48<01:36,  2.14it/s] 62%|██████▏   | 340/545 [01:49<01:34,  2.16it/s]                                                  62%|██████▏   | 340/545 [01:49<01:34,  2.16it/s] 63%|██████▎   | 341/545 [01:49<01:34,  2.15it/s] 63%|██████▎   | 342/545 [01:50<01:34,  2.16it/s] 63%|██████▎   | 343/545 [01:50<01:32,  2.18it/s] 63%|██████▎   | 344/545 [01:51<01:33,  2.16it/s] 63%|██████▎   | 345/545 [01:51<01:33,  2.15it/s] 63%|██████▎   | 346/545 [01:52<01:33,  2.14it/s] 64%|██████▎   | 347/545 [01:52<01:25,  2.31it/s] 64%|██████▍   | 348/545 [01:52<01:13,  2.68it/s] 64%|██████▍   | 349/545 [01:53<01:05,  3.02it/s] 64%|██████▍   | 350/545 [01:53<00:58,  3.31it/s]                                                  64%|██████▍   | 350/545 [01:53<00:58,  3.31it/s] 64%|██████▍   | 351/545 [01:53<00:54,  3.53it/s] 65%|██████▍   | 352/545 [01:53<01:04,  2.98it/s] 65%|██████▍   | 353/545 [01:54<01:11,  2.69it/s] 65%|██████▍   | 354/545 [01:54<01:16,  2.51it/s] 65%|██████▌   | 355/545 [01:55<01:19,  2.40it/s] 65%|██████▌   | 356/545 [01:55<01:21,  2.33it/s] 66%|██████▌   | 357/545 [01:56<01:22,  2.28it/s] 66%|██████▌   | 358/545 [01:56<01:22,  2.26it/s] 66%|██████▌   | 359/545 [01:57<01:23,  2.23it/s] 66%|██████▌   | 360/545 [01:57<01:23,  2.22it/s]                                                  66%|██████▌   | 360/545 [01:57<01:23,  2.22it/s] 66%|██████▌   | 361/545 [01:58<01:24,  2.19it/s] 66%|██████▋   | 362/545 [01:58<01:23,  2.18it/s] 67%|██████▋   | 363/545 [01:58<01:23,  2.18it/s] 67%|██████▋   | 364/545 [01:59<01:23,  2.18it/s] 67%|██████▋   | 365/545 [01:59<01:22,  2.18it/s] 67%|██████▋   | 366/545 [02:00<01:21,  2.18it/s] 67%|██████▋   | 367/545 [02:00<01:21,  2.19it/s] 68%|██████▊   | 368/545 [02:01<01:20,  2.19it/s] 68%|██████▊   | 369/545 [02:01<01:20,  2.18it/s] 68%|██████▊   | 370/545 [02:02<01:20,  2.18it/s]                                                  68%|██████▊   | 370/545 [02:02<01:20,  2.18it/s] 68%|██████▊   | 371/545 [02:02<01:19,  2.18it/s] 68%|██████▊   | 372/545 [02:03<01:19,  2.17it/s] 68%|██████▊   | 373/545 [02:03<01:19,  2.17it/s] 69%|██████▊   | 374/545 [02:04<01:18,  2.17it/s] 69%|██████▉   | 375/545 [02:04<01:18,  2.17it/s] 69%|██████▉   | 376/545 [02:04<01:17,  2.17it/s] 69%|██████▉   | 377/545 [02:05<01:17,  2.17it/s] 69%|██████▉   | 378/545 [02:05<01:16,  2.17it/s] 70%|██████▉   | 379/545 [02:06<01:16,  2.17it/s] 70%|██████▉   | 380/545 [02:06<01:16,  2.17it/s]                                                  70%|██████▉   | 380/545 [02:06<01:16,  2.17it/s] 70%|██████▉   | 381/545 [02:07<01:15,  2.17it/s] 70%|███████   | 382/545 [02:07<01:15,  2.17it/s] 70%|███████   | 383/545 [02:08<01:14,  2.18it/s] 70%|███████   | 384/545 [02:08<01:13,  2.18it/s] 71%|███████   | 385/545 [02:09<01:13,  2.18it/s] 71%|███████   | 386/545 [02:09<01:12,  2.19it/s] 71%|███████   | 387/545 [02:10<01:12,  2.19it/s] 71%|███████   | 388/545 [02:10<01:11,  2.19it/s] 71%|███████▏  | 389/545 [02:10<01:11,  2.19it/s] 72%|███████▏  | 390/545 [02:11<01:10,  2.19it/s]                                                  72%|███████▏  | 390/545 [02:11<01:10,  2.19it/s] 72%|███████▏  | 391/545 [02:11<01:10,  2.19it/s] 72%|███████▏  | 392/545 [02:12<01:10,  2.18it/s] 72%|███████▏  | 393/545 [02:12<01:09,  2.17it/s] 72%|███████▏  | 394/545 [02:13<01:09,  2.18it/s] 72%|███████▏  | 395/545 [02:13<01:08,  2.18it/s] 73%|███████▎  | 396/545 [02:14<01:08,  2.17it/s] 73%|███████▎  | 397/545 [02:14<01:08,  2.16it/s] 73%|███████▎  | 398/545 [02:15<01:08,  2.15it/s] 73%|███████▎  | 399/545 [02:15<01:07,  2.16it/s] 73%|███████▎  | 400/545 [02:16<01:07,  2.15it/s]                                                  73%|███████▎  | 400/545 [02:16<01:07,  2.15it/s] 74%|███████▎  | 401/545 [02:16<01:07,  2.14it/s] 74%|███████▍  | 402/545 [02:16<01:06,  2.14it/s] 74%|███████▍  | 403/545 [02:17<01:06,  2.15it/s] 74%|███████▍  | 404/545 [02:17<01:05,  2.16it/s] 74%|███████▍  | 405/545 [02:18<01:05,  2.15it/s] 74%|███████▍  | 406/545 [02:18<01:04,  2.14it/s] 75%|███████▍  | 407/545 [02:19<01:04,  2.15it/s] 75%|███████▍  | 408/545 [02:19<01:03,  2.15it/s] 75%|███████▌  | 409/545 [02:20<01:03,  2.15it/s] 75%|███████▌  | 410/545 [02:20<01:03,  2.14it/s]                                                  75%|███████▌  | 410/545 [02:20<01:03,  2.14it/s] 75%|███████▌  | 411/545 [02:21<01:02,  2.14it/s] 76%|███████▌  | 412/545 [02:21<01:02,  2.14it/s] 76%|███████▌  | 413/545 [02:22<01:01,  2.15it/s] 76%|███████▌  | 414/545 [02:22<01:01,  2.13it/s] 76%|███████▌  | 415/545 [02:23<01:01,  2.12it/s] 76%|███████▋  | 416/545 [02:23<01:00,  2.12it/s] 77%|███████▋  | 417/545 [02:23<01:00,  2.12it/s] 77%|███████▋  | 418/545 [02:24<00:59,  2.12it/s] 77%|███████▋  | 419/545 [02:24<00:59,  2.13it/s] 77%|███████▋  | 420/545 [02:25<00:58,  2.13it/s]                                                  77%|███████▋  | 420/545 [02:25<00:58,  2.13it/s] 77%|███████▋  | 421/545 [02:25<00:58,  2.14it/s] 77%|███████▋  | 422/545 [02:26<00:57,  2.14it/s] 78%|███████▊  | 423/545 [02:26<00:57,  2.14it/s] 78%|███████▊  | 424/545 [02:27<00:56,  2.14it/s] 78%|███████▊  | 425/545 [02:27<00:55,  2.14it/s] 78%|███████▊  | 426/545 [02:28<00:55,  2.14it/s] 78%|███████▊  | 427/545 [02:28<00:55,  2.12it/s] 79%|███████▊  | 428/545 [02:29<00:55,  2.13it/s] 79%|███████▊  | 429/545 [02:29<00:54,  2.14it/s] 79%|███████▉  | 430/545 [02:30<00:54,  2.13it/s]                                                  79%|███████▉  | 430/545 [02:30<00:54,  2.13it/s] 79%|███████▉  | 431/545 [02:30<00:53,  2.13it/s] 79%|███████▉  | 432/545 [02:31<00:53,  2.12it/s] 79%|███████▉  | 433/545 [02:31<00:52,  2.13it/s] 80%|███████▉  | 434/545 [02:31<00:52,  2.12it/s] 80%|███████▉  | 435/545 [02:32<00:51,  2.12it/s] 80%|████████  | 436/545 [02:32<00:51,  2.13it/s]{'eval_loss': 1.0602658987045288, 'eval_runtime': 2.0234, 'eval_samples_per_second': 19.274, 'eval_steps_per_second': 19.274, 'eval_mean_token_accuracy': 0.7733976031417278, 'epoch': 3.0}
{'loss': 0.9682, 'grad_norm': 0.1508956104516983, 'learning_rate': 7.926605504587157e-05, 'mean_token_accuracy': 0.7865251998106638, 'epoch': 3.03}
{'loss': 0.9454, 'grad_norm': 0.18582956492900848, 'learning_rate': 7.559633027522937e-05, 'mean_token_accuracy': 0.7889982432126998, 'epoch': 3.12}
{'loss': 0.9848, 'grad_norm': 0.13730423152446747, 'learning_rate': 7.192660550458716e-05, 'mean_token_accuracy': 0.781115411221981, 'epoch': 3.21}
{'loss': 0.9835, 'grad_norm': 0.14021003246307373, 'learning_rate': 6.825688073394497e-05, 'mean_token_accuracy': 0.7771501943469048, 'epoch': 3.3}
{'loss': 1.0069, 'grad_norm': 0.14156925678253174, 'learning_rate': 6.458715596330276e-05, 'mean_token_accuracy': 0.7732054367661476, 'epoch': 3.39}
{'loss': 0.9597, 'grad_norm': 0.1540355235338211, 'learning_rate': 6.0917431192660556e-05, 'mean_token_accuracy': 0.7859702616930008, 'epoch': 3.49}
{'loss': 0.9832, 'grad_norm': 0.13319270312786102, 'learning_rate': 5.724770642201836e-05, 'mean_token_accuracy': 0.7814156994223594, 'epoch': 3.58}
{'loss': 0.9506, 'grad_norm': 0.13586930930614471, 'learning_rate': 5.357798165137615e-05, 'mean_token_accuracy': 0.7856064334511756, 'epoch': 3.67}
{'loss': 0.9617, 'grad_norm': 0.13872089982032776, 'learning_rate': 4.990825688073395e-05, 'mean_token_accuracy': 0.7856601402163506, 'epoch': 3.76}
{'loss': 0.9796, 'grad_norm': 0.15548698604106903, 'learning_rate': 4.623853211009175e-05, 'mean_token_accuracy': 0.7741303712129592, 'epoch': 3.85}
{'loss': 1.001, 'grad_norm': 0.16792534291744232, 'learning_rate': 4.256880733944955e-05, 'mean_token_accuracy': 0.7726474031805992, 'epoch': 3.94}

  0%|          | 0/39 [00:00<?, ?it/s][A
  8%|▊         | 3/39 [00:00<00:01, 26.18it/s][A
 15%|█▌        | 6/39 [00:00<00:01, 19.98it/s][A
 23%|██▎       | 9/39 [00:00<00:01, 20.51it/s][A
 31%|███       | 12/39 [00:00<00:01, 19.69it/s][A
 38%|███▊      | 15/39 [00:00<00:01, 19.07it/s][A
 46%|████▌     | 18/39 [00:00<00:01, 19.68it/s][A
 51%|█████▏    | 20/39 [00:01<00:00, 19.13it/s][A
 56%|█████▋    | 22/39 [00:01<00:00, 18.76it/s][A
 62%|██████▏   | 24/39 [00:01<00:00, 18.53it/s][A
 69%|██████▉   | 27/39 [00:01<00:00, 19.23it/s][A
 74%|███████▍  | 29/39 [00:01<00:00, 18.84it/s][A
 79%|███████▉  | 31/39 [00:01<00:00, 18.61it/s][A
 85%|████████▍ | 33/39 [00:01<00:00, 18.42it/s][A
 92%|█████████▏| 36/39 [00:01<00:00, 19.26it/s][A
 97%|█████████▋| 38/39 [00:01<00:00, 18.91it/s][A                                                 
                                               [A 80%|████████  | 436/545 [02:34<00:51,  2.13it/s]
100%|██████████| 39/39 [00:02<00:00, 18.91it/s][A
                                               [A 80%|████████  | 437/545 [02:36<02:30,  1.39s/it] 80%|████████  | 438/545 [02:36<01:59,  1.11s/it] 81%|████████  | 439/545 [02:37<01:37,  1.09it/s] 81%|████████  | 440/545 [02:37<01:22,  1.27it/s]                                                  81%|████████  | 440/545 [02:37<01:22,  1.27it/s] 81%|████████  | 441/545 [02:38<01:11,  1.45it/s] 81%|████████  | 442/545 [02:38<01:04,  1.60it/s] 81%|████████▏ | 443/545 [02:39<00:59,  1.73it/s] 81%|████████▏ | 444/545 [02:39<00:55,  1.83it/s] 82%|████████▏ | 445/545 [02:40<00:52,  1.91it/s] 82%|████████▏ | 446/545 [02:40<00:50,  1.97it/s] 82%|████████▏ | 447/545 [02:41<00:48,  2.02it/s] 82%|████████▏ | 448/545 [02:41<00:47,  2.05it/s] 82%|████████▏ | 449/545 [02:42<00:46,  2.08it/s] 83%|████████▎ | 450/545 [02:42<00:45,  2.09it/s]                                                  83%|████████▎ | 450/545 [02:42<00:45,  2.09it/s] 83%|████████▎ | 451/545 [02:42<00:44,  2.10it/s] 83%|████████▎ | 452/545 [02:43<00:43,  2.13it/s] 83%|████████▎ | 453/545 [02:43<00:43,  2.12it/s] 83%|████████▎ | 454/545 [02:44<00:43,  2.11it/s] 83%|████████▎ | 455/545 [02:44<00:42,  2.11it/s] 84%|████████▎ | 456/545 [02:45<00:40,  2.20it/s] 84%|████████▍ | 457/545 [02:45<00:34,  2.54it/s] 84%|████████▍ | 458/545 [02:45<00:30,  2.85it/s] 84%|████████▍ | 459/545 [02:46<00:27,  3.13it/s] 84%|████████▍ | 460/545 [02:46<00:25,  3.35it/s]                                                  84%|████████▍ | 460/545 [02:46<00:25,  3.35it/s] 85%|████████▍ | 461/545 [02:46<00:28,  3.00it/s] 85%|████████▍ | 462/545 [02:47<00:31,  2.66it/s] 85%|████████▍ | 463/545 [02:47<00:33,  2.48it/s] 85%|████████▌ | 464/545 [02:48<00:34,  2.35it/s] 85%|████████▌ | 465/545 [02:48<00:35,  2.28it/s] 86%|████████▌ | 466/545 [02:49<00:35,  2.24it/s] 86%|████████▌ | 467/545 [02:49<00:35,  2.22it/s] 86%|████████▌ | 468/545 [02:49<00:35,  2.19it/s] 86%|████████▌ | 469/545 [02:50<00:34,  2.17it/s] 86%|████████▌ | 470/545 [02:50<00:34,  2.17it/s]                                                  86%|████████▌ | 470/545 [02:50<00:34,  2.17it/s] 86%|████████▋ | 471/545 [02:51<00:34,  2.16it/s] 87%|████████▋ | 472/545 [02:51<00:33,  2.16it/s] 87%|████████▋ | 473/545 [02:52<00:33,  2.16it/s] 87%|████████▋ | 474/545 [02:52<00:32,  2.16it/s] 87%|████████▋ | 475/545 [02:53<00:32,  2.16it/s] 87%|████████▋ | 476/545 [02:53<00:31,  2.16it/s] 88%|████████▊ | 477/545 [02:54<00:31,  2.16it/s] 88%|████████▊ | 478/545 [02:54<00:31,  2.15it/s] 88%|████████▊ | 479/545 [02:55<00:30,  2.15it/s] 88%|████████▊ | 480/545 [02:55<00:30,  2.15it/s]                                                  88%|████████▊ | 480/545 [02:55<00:30,  2.15it/s] 88%|████████▊ | 481/545 [02:56<00:29,  2.15it/s] 88%|████████▊ | 482/545 [02:56<00:29,  2.14it/s] 89%|████████▊ | 483/545 [02:56<00:29,  2.14it/s] 89%|████████▉ | 484/545 [02:57<00:28,  2.13it/s] 89%|████████▉ | 485/545 [02:57<00:28,  2.14it/s] 89%|████████▉ | 486/545 [02:58<00:27,  2.14it/s] 89%|████████▉ | 487/545 [02:58<00:27,  2.13it/s] 90%|████████▉ | 488/545 [02:59<00:26,  2.13it/s] 90%|████████▉ | 489/545 [02:59<00:26,  2.12it/s] 90%|████████▉ | 490/545 [03:00<00:24,  2.23it/s]                                                  90%|████████▉ | 490/545 [03:00<00:24,  2.23it/s] 90%|█████████ | 491/545 [03:00<00:24,  2.21it/s] 90%|█████████ | 492/545 [03:01<00:24,  2.19it/s] 90%|█████████ | 493/545 [03:01<00:23,  2.17it/s] 91%|█████████ | 494/545 [03:02<00:23,  2.16it/s] 91%|█████████ | 495/545 [03:02<00:23,  2.15it/s] 91%|█████████ | 496/545 [03:02<00:22,  2.15it/s] 91%|█████████ | 497/545 [03:03<00:19,  2.46it/s] 91%|█████████▏| 498/545 [03:03<00:16,  2.79it/s] 92%|█████████▏| 499/545 [03:03<00:14,  3.09it/s] 92%|█████████▏| 500/545 [03:03<00:13,  3.35it/s]                                                  92%|█████████▏| 500/545 [03:03<00:13,  3.35it/s] 92%|█████████▏| 501/545 [03:04<00:12,  3.54it/s] 92%|█████████▏| 502/545 [03:04<00:11,  3.71it/s] 92%|█████████▏| 503/545 [03:04<00:10,  3.85it/s] 92%|█████████▏| 504/545 [03:04<00:10,  3.98it/s] 93%|█████████▎| 505/545 [03:05<00:09,  4.04it/s] 93%|█████████▎| 506/545 [03:05<00:09,  4.11it/s] 93%|█████████▎| 507/545 [03:05<00:09,  4.13it/s] 93%|█████████▎| 508/545 [03:05<00:08,  4.17it/s] 93%|█████████▎| 509/545 [03:06<00:08,  4.21it/s] 94%|█████████▎| 510/545 [03:06<00:08,  4.19it/s]                                                  94%|█████████▎| 510/545 [03:06<00:08,  4.19it/s] 94%|█████████▍| 511/545 [03:06<00:08,  4.21it/s] 94%|█████████▍| 512/545 [03:06<00:07,  4.22it/s] 94%|█████████▍| 513/545 [03:07<00:07,  4.19it/s] 94%|█████████▍| 514/545 [03:07<00:07,  4.22it/s] 94%|█████████▍| 515/545 [03:07<00:07,  4.21it/s] 95%|█████████▍| 516/545 [03:07<00:06,  4.23it/s] 95%|█████████▍| 517/545 [03:08<00:06,  4.23it/s] 95%|█████████▌| 518/545 [03:08<00:06,  4.19it/s] 95%|█████████▌| 519/545 [03:08<00:06,  4.15it/s] 95%|█████████▌| 520/545 [03:08<00:06,  4.13it/s]                                                  95%|█████████▌| 520/545 [03:08<00:06,  4.13it/s] 96%|█████████▌| 521/545 [03:09<00:05,  4.08it/s] 96%|█████████▌| 522/545 [03:09<00:05,  4.06it/s] 96%|█████████▌| 523/545 [03:09<00:05,  4.07it/s] 96%|█████████▌| 524/545 [03:09<00:05,  4.07it/s] 96%|█████████▋| 525/545 [03:09<00:04,  4.06it/s] 97%|█████████▋| 526/545 [03:10<00:04,  4.06it/s] 97%|█████████▋| 527/545 [03:10<00:04,  4.05it/s] 97%|█████████▋| 528/545 [03:10<00:04,  4.05it/s] 97%|█████████▋| 529/545 [03:10<00:03,  4.05it/s] 97%|█████████▋| 530/545 [03:11<00:03,  4.07it/s]                                                  97%|█████████▋| 530/545 [03:11<00:03,  4.07it/s] 97%|█████████▋| 531/545 [03:11<00:03,  4.12it/s] 98%|█████████▊| 532/545 [03:11<00:03,  4.14it/s] 98%|█████████▊| 533/545 [03:11<00:02,  4.18it/s] 98%|█████████▊| 534/545 [03:12<00:02,  4.20it/s] 98%|█████████▊| 535/545 [03:12<00:02,  4.20it/s] 98%|█████████▊| 536/545 [03:12<00:02,  4.19it/s] 99%|█████████▊| 537/545 [03:12<00:01,  4.21it/s] 99%|█████████▊| 538/545 [03:13<00:01,  4.15it/s] 99%|█████████▉| 539/545 [03:13<00:01,  4.16it/s] 99%|█████████▉| 540/545 [03:13<00:01,  4.13it/s]                                                  99%|█████████▉| 540/545 [03:13<00:01,  4.13it/s] 99%|█████████▉| 541/545 [03:13<00:00,  4.14it/s] 99%|█████████▉| 542/545 [03:14<00:00,  4.13it/s]100%|█████████▉| 543/545 [03:14<00:00,  4.10it/s]100%|█████████▉| 544/545 [03:14<00:00,  4.08it/s]100%|██████████| 545/545 [03:14<00:00,  4.11it/s]{'eval_loss': 1.0499725341796875, 'eval_runtime': 2.0597, 'eval_samples_per_second': 18.934, 'eval_steps_per_second': 18.934, 'eval_mean_token_accuracy': 0.7716828764431061, 'epoch': 4.0}
{'loss': 0.9778, 'grad_norm': 0.14184579253196716, 'learning_rate': 3.889908256880734e-05, 'mean_token_accuracy': 0.7785605639219284, 'epoch': 4.04}
{'loss': 0.9463, 'grad_norm': 0.1420900672674179, 'learning_rate': 3.5229357798165144e-05, 'mean_token_accuracy': 0.7856282681226731, 'epoch': 4.13}
{'loss': 0.9582, 'grad_norm': 0.16972796618938446, 'learning_rate': 3.155963302752294e-05, 'mean_token_accuracy': 0.7804103136062622, 'epoch': 4.22}
{'loss': 0.9923, 'grad_norm': 0.14878733456134796, 'learning_rate': 2.7889908256880736e-05, 'mean_token_accuracy': 0.7804078057408332, 'epoch': 4.31}
{'loss': 0.9845, 'grad_norm': 0.15109305083751678, 'learning_rate': 2.4220183486238534e-05, 'mean_token_accuracy': 0.7789606168866158, 'epoch': 4.4}
{'loss': 0.9271, 'grad_norm': 0.15962497889995575, 'learning_rate': 2.0550458715596332e-05, 'mean_token_accuracy': 0.794645619392395, 'epoch': 4.5}
{'loss': 0.9696, 'grad_norm': 0.19559141993522644, 'learning_rate': 1.688073394495413e-05, 'mean_token_accuracy': 0.779714024066925, 'epoch': 4.59}
{'loss': 0.9511, 'grad_norm': 0.14591176807880402, 'learning_rate': 1.3211009174311927e-05, 'mean_token_accuracy': 0.7865931689739227, 'epoch': 4.68}
{'loss': 0.9396, 'grad_norm': 0.15393999218940735, 'learning_rate': 9.541284403669725e-06, 'mean_token_accuracy': 0.7871871381998062, 'epoch': 4.77}
{'loss': 0.9659, 'grad_norm': 0.1514613926410675, 'learning_rate': 5.871559633027524e-06, 'mean_token_accuracy': 0.7778553888201714, 'epoch': 4.86}
{'loss': 0.9277, 'grad_norm': 0.1611947864294052, 'learning_rate': 2.2018348623853215e-06, 'mean_token_accuracy': 0.7904515236616134, 'epoch': 4.95}

  0%|          | 0/39 [00:00<?, ?it/s][A
 13%|█▎        | 5/39 [00:00<00:00, 45.45it/s][A
 26%|██▌       | 10/39 [00:00<00:00, 40.03it/s][A
 38%|███▊      | 15/39 [00:00<00:00, 38.76it/s][A
 49%|████▊     | 19/39 [00:00<00:00, 38.47it/s][A
 59%|█████▉    | 23/39 [00:00<00:00, 37.89it/s][A
 69%|██████▉   | 27/39 [00:00<00:00, 37.31it/s][A
 79%|███████▉  | 31/39 [00:00<00:00, 37.06it/s][A
 90%|████████▉ | 35/39 [00:00<00:00, 37.12it/s][A                                                 
                                               [A100%|██████████| 545/545 [03:15<00:00,  4.11it/s]
100%|██████████| 39/39 [00:01<00:00, 37.12it/s][A
                                               [A                                                 100%|██████████| 545/545 [03:16<00:00,  4.11it/s]100%|██████████| 545/545 [03:16<00:00,  2.77it/s]
{'eval_loss': 1.0510114431381226, 'eval_runtime': 1.0424, 'eval_samples_per_second': 37.412, 'eval_steps_per_second': 37.412, 'eval_mean_token_accuracy': 0.7751213130304369, 'epoch': 5.0}
{'train_runtime': 198.066, 'train_samples_per_second': 11.006, 'train_steps_per_second': 2.752, 'train_loss': 1.083741651762516, 'epoch': 5.0}
✓ Metrics saved to: ./results/llama-arc-lora-attention/metrics_lora-attention.json
[1;34mwandb[0m: 🚀 View run [33mbright-glade-40[0m at: [34mhttps://wandb.ai/waynehacking8-national-taiwan-university-of-science-and-/huggingface/runs/l3gvu6b9[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20251012_154252-l3gvu6b9/logs[0m
✓ Experiment 1 completed

========================================
Experiment 2/3: llama-arc-lora-all
========================================
Model: meta-llama/Llama-3.2-1B-Instruct
Dataset: allenai/ai2_arc (ARC-Easy)
Method: lora-all
Max seq length: 512
Output: ./results/llama-arc-lora-all

/home/wayneleo8/lora_without_regret/sft_compare.py:222: FutureWarning: `tokenizer` is deprecated and removed starting from version 0.16.0 for `SFTTrainer.__init__`. Use `processing_class` instead.
  trainer = SFTTrainer(
The model is already on multiple devices. Skipping the move to device specified in `args`.
The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'eos_token_id': 128009, 'pad_token_id': 128009}.
wandb: Using wandb-core as the SDK backend. Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: waynehacking8 (waynehacking8-national-taiwan-university-of-science-and-). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.18.3
wandb: Run data is saved locally in /home/wayneleo8/lora_without_regret/wandb/run-20251012_154624-mgvftn2u
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run pretty-voice-42
wandb: ⭐️ View project at https://wandb.ai/waynehacking8-national-taiwan-university-of-science-and-/huggingface
wandb: 🚀 View run at https://wandb.ai/waynehacking8-national-taiwan-university-of-science-and-/huggingface/runs/mgvftn2u
Training samples: 2251
Validation samples: 200

============================================================
Training Configuration:
  Method: LORA-ALL
  Learning Rate: 0.0002
  Epochs: 5
  Early Stopping Patience: 2 epochs
  Batch Size: 1 x 4 = 4
============================================================

  0%|          | 0/545 [00:00<?, ?it/s]  0%|          | 1/545 [00:00<04:33,  1.99it/s]  0%|          | 2/545 [00:00<03:32,  2.56it/s]  1%|          | 3/545 [00:01<03:10,  2.84it/s]  1%|          | 4/545 [00:01<03:01,  2.99it/s]  1%|          | 5/545 [00:01<02:54,  3.09it/s]  1%|          | 6/545 [00:02<02:52,  3.12it/s]  1%|▏         | 7/545 [00:02<02:54,  3.08it/s]  1%|▏         | 8/545 [00:02<02:52,  3.12it/s]  2%|▏         | 9/545 [00:03<02:50,  3.15it/s]  2%|▏         | 10/545 [00:03<02:49,  3.15it/s]                                                  2%|▏         | 10/545 [00:03<02:49,  3.15it/s]  2%|▏         | 11/545 [00:03<02:48,  3.17it/s]  2%|▏         | 12/545 [00:03<02:47,  3.17it/s]  2%|▏         | 13/545 [00:04<02:47,  3.18it/s]  3%|▎         | 14/545 [00:04<02:46,  3.18it/s]  3%|▎         | 15/545 [00:04<02:45,  3.20it/s]  3%|▎         | 16/545 [00:05<02:43,  3.23it/s]  3%|▎         | 17/545 [00:05<02:42,  3.25it/s]  3%|▎         | 18/545 [00:05<02:41,  3.25it/s]  3%|▎         | 19/545 [00:06<02:41,  3.26it/s]  4%|▎         | 20/545 [00:06<02:40,  3.27it/s]                                                  4%|▎         | 20/545 [00:06<02:40,  3.27it/s]  4%|▍         | 21/545 [00:06<02:40,  3.26it/s]  4%|▍         | 22/545 [00:07<02:40,  3.26it/s]  4%|▍         | 23/545 [00:07<02:40,  3.26it/s]  4%|▍         | 24/545 [00:07<02:39,  3.27it/s]  5%|▍         | 25/545 [00:07<02:38,  3.27it/s]  5%|▍         | 26/545 [00:08<02:37,  3.29it/s]  5%|▍         | 27/545 [00:08<02:37,  3.29it/s]  5%|▌         | 28/545 [00:08<02:37,  3.29it/s]  5%|▌         | 29/545 [00:09<02:36,  3.29it/s]  6%|▌         | 30/545 [00:09<02:36,  3.29it/s]                                                  6%|▌         | 30/545 [00:09<02:36,  3.29it/s]  6%|▌         | 31/545 [00:09<02:36,  3.29it/s]  6%|▌         | 32/545 [00:10<02:36,  3.27it/s]  6%|▌         | 33/545 [00:10<02:36,  3.27it/s]  6%|▌         | 34/545 [00:10<02:36,  3.26it/s]  6%|▋         | 35/545 [00:10<02:36,  3.26it/s]  7%|▋         | 36/545 [00:11<02:36,  3.25it/s]  7%|▋         | 37/545 [00:11<02:37,  3.23it/s]  7%|▋         | 38/545 [00:11<02:36,  3.24it/s]  7%|▋         | 39/545 [00:12<02:36,  3.24it/s]  7%|▋         | 40/545 [00:12<02:35,  3.24it/s]                                                  7%|▋         | 40/545 [00:12<02:35,  3.24it/s]  8%|▊         | 41/545 [00:12<02:36,  3.23it/s]  8%|▊         | 42/545 [00:13<02:36,  3.22it/s]  8%|▊         | 43/545 [00:13<02:36,  3.20it/s]  8%|▊         | 44/545 [00:13<02:36,  3.21it/s]  8%|▊         | 45/545 [00:14<02:35,  3.21it/s]  8%|▊         | 46/545 [00:14<02:35,  3.21it/s]  9%|▊         | 47/545 [00:14<02:34,  3.21it/s]  9%|▉         | 48/545 [00:15<02:34,  3.22it/s]  9%|▉         | 49/545 [00:15<02:34,  3.21it/s]  9%|▉         | 50/545 [00:15<02:34,  3.21it/s]                                                  9%|▉         | 50/545 [00:15<02:34,  3.21it/s]  9%|▉         | 51/545 [00:15<02:33,  3.21it/s] 10%|▉         | 52/545 [00:16<02:33,  3.22it/s] 10%|▉         | 53/545 [00:16<02:31,  3.24it/s] 10%|▉         | 54/545 [00:16<02:31,  3.25it/s] 10%|█         | 55/545 [00:17<02:30,  3.26it/s] 10%|█         | 56/545 [00:17<02:29,  3.27it/s] 10%|█         | 57/545 [00:17<02:29,  3.27it/s] 11%|█         | 58/545 [00:18<02:28,  3.28it/s] 11%|█         | 59/545 [00:18<02:28,  3.28it/s] 11%|█         | 60/545 [00:18<02:27,  3.28it/s]                                                 11%|█         | 60/545 [00:18<02:27,  3.28it/s] 11%|█         | 61/545 [00:19<02:28,  3.26it/s] 11%|█▏        | 62/545 [00:19<02:28,  3.26it/s] 12%|█▏        | 63/545 [00:19<02:27,  3.26it/s] 12%|█▏        | 64/545 [00:19<02:27,  3.26it/s] 12%|█▏        | 65/545 [00:20<02:27,  3.26it/s] 12%|█▏        | 66/545 [00:20<02:26,  3.27it/s] 12%|█▏        | 67/545 [00:20<02:26,  3.27it/s] 12%|█▏        | 68/545 [00:21<02:26,  3.26it/s] 13%|█▎        | 69/545 [00:21<02:25,  3.28it/s] 13%|█▎        | 70/545 [00:21<02:24,  3.28it/s]                                                 13%|█▎        | 70/545 [00:21<02:24,  3.28it/s] 13%|█▎        | 71/545 [00:22<02:24,  3.28it/s] 13%|█▎        | 72/545 [00:22<02:23,  3.29it/s] 13%|█▎        | 73/545 [00:22<02:23,  3.30it/s] 14%|█▎        | 74/545 [00:22<02:22,  3.30it/s] 14%|█▍        | 75/545 [00:23<02:23,  3.28it/s] 14%|█▍        | 76/545 [00:23<02:22,  3.28it/s] 14%|█▍        | 77/545 [00:23<02:23,  3.27it/s] 14%|█▍        | 78/545 [00:24<02:23,  3.26it/s] 14%|█▍        | 79/545 [00:24<02:22,  3.27it/s] 15%|█▍        | 80/545 [00:24<02:22,  3.27it/s]                                                 15%|█▍        | 80/545 [00:24<02:22,  3.27it/s] 15%|█▍        | 81/545 [00:25<02:22,  3.26it/s] 15%|█▌        | 82/545 [00:25<02:21,  3.26it/s] 15%|█▌        | 83/545 [00:25<02:21,  3.27it/s] 15%|█▌        | 84/545 [00:26<02:20,  3.27it/s] 16%|█▌        | 85/545 [00:26<02:21,  3.26it/s] 16%|█▌        | 86/545 [00:26<02:21,  3.24it/s] 16%|█▌        | 87/545 [00:26<02:21,  3.24it/s] 16%|█▌        | 88/545 [00:27<02:21,  3.23it/s] 16%|█▋        | 89/545 [00:27<02:21,  3.23it/s] 17%|█▋        | 90/545 [00:27<02:21,  3.22it/s]                                                 17%|█▋        | 90/545 [00:27<02:21,  3.22it/s] 17%|█▋        | 91/545 [00:28<02:21,  3.21it/s] 17%|█▋        | 92/545 [00:28<02:21,  3.20it/s] 17%|█▋        | 93/545 [00:28<02:18,  3.26it/s] 17%|█▋        | 94/545 [00:29<02:19,  3.24it/s] 17%|█▋        | 95/545 [00:29<02:19,  3.23it/s] 18%|█▊        | 96/545 [00:29<02:18,  3.24it/s] 18%|█▊        | 97/545 [00:30<02:17,  3.25it/s] 18%|█▊        | 98/545 [00:30<02:17,  3.26it/s] 18%|█▊        | 99/545 [00:30<02:16,  3.27it/s] 18%|█▊        | 100/545 [00:30<02:16,  3.26it/s]                                                  18%|█▊        | 100/545 [00:31<02:16,  3.26it/s] 19%|█▊        | 101/545 [00:31<02:17,  3.23it/s] 19%|█▊        | 102/545 [00:31<02:17,  3.23it/s] 19%|█▉        | 103/545 [00:31<02:17,  3.22it/s] 19%|█▉        | 104/545 [00:32<02:16,  3.22it/s] 19%|█▉        | 105/545 [00:32<02:15,  3.25it/s] 19%|█▉        | 106/545 [00:32<02:14,  3.26it/s] 20%|█▉        | 107/545 [00:33<02:14,  3.26it/s] 20%|█▉        | 108/545 [00:33<02:14,  3.24it/s] 20%|██        | 109/545 [00:33<02:15,  3.23it/s]{'loss': 2.0215, 'grad_norm': 0.19237983226776123, 'learning_rate': 0.00019669724770642204, 'mean_token_accuracy': 0.6732289463281631, 'epoch': 0.09}
{'loss': 1.4359, 'grad_norm': 0.33334359526634216, 'learning_rate': 0.00019302752293577982, 'mean_token_accuracy': 0.7399869814515114, 'epoch': 0.18}
{'loss': 1.3054, 'grad_norm': 0.25949281454086304, 'learning_rate': 0.00018935779816513763, 'mean_token_accuracy': 0.7557977348566055, 'epoch': 0.28}
{'loss': 1.1776, 'grad_norm': 0.24381251633167267, 'learning_rate': 0.00018568807339449544, 'mean_token_accuracy': 0.761878727376461, 'epoch': 0.37}
{'loss': 1.1187, 'grad_norm': 0.16358253359794617, 'learning_rate': 0.00018201834862385322, 'mean_token_accuracy': 0.7588442310690879, 'epoch': 0.46}
{'loss': 1.0628, 'grad_norm': 0.15720748901367188, 'learning_rate': 0.00017834862385321103, 'mean_token_accuracy': 0.7639384284615517, 'epoch': 0.55}
{'loss': 1.042, 'grad_norm': 0.10380449146032333, 'learning_rate': 0.00017467889908256884, 'mean_token_accuracy': 0.772691299021244, 'epoch': 0.64}
{'loss': 1.06, 'grad_norm': 0.11369064450263977, 'learning_rate': 0.00017100917431192662, 'mean_token_accuracy': 0.7662883147597312, 'epoch': 0.73}
{'loss': 0.9904, 'grad_norm': 0.10728057473897934, 'learning_rate': 0.00016733944954128442, 'mean_token_accuracy': 0.7793493926525116, 'epoch': 0.83}
{'loss': 1.0304, 'grad_norm': 0.11151673644781113, 'learning_rate': 0.00016366972477064223, 'mean_token_accuracy': 0.7744493290781975, 'epoch': 0.92}

  0%|          | 0/39 [00:00<?, ?it/s][A
 13%|█▎        | 5/39 [00:00<00:00, 38.47it/s][A
 23%|██▎       | 9/39 [00:00<00:00, 33.98it/s][A
 33%|███▎      | 13/39 [00:00<00:00, 32.40it/s][A
 44%|████▎     | 17/39 [00:00<00:00, 31.70it/s][A
 54%|█████▍    | 21/39 [00:00<00:00, 31.84it/s][A
 64%|██████▍   | 25/39 [00:00<00:00, 31.71it/s][A
 74%|███████▍  | 29/39 [00:00<00:00, 31.96it/s][A
 85%|████████▍ | 33/39 [00:01<00:00, 32.03it/s][A
 95%|█████████▍| 37/39 [00:01<00:00, 31.84it/s][A                                                 
                                               [A 20%|██        | 109/545 [00:35<02:15,  3.23it/s]
100%|██████████| 39/39 [00:01<00:00, 31.84it/s][A
                                               [A 20%|██        | 110/545 [00:37<09:03,  1.25s/it]                                                  20%|██        | 110/545 [00:37<09:03,  1.25s/it] 20%|██        | 111/545 [00:37<06:59,  1.03it/s] 21%|██        | 112/545 [00:37<05:32,  1.30it/s] 21%|██        | 113/545 [00:38<04:31,  1.59it/s] 21%|██        | 114/545 [00:38<03:49,  1.88it/s] 21%|██        | 115/545 [00:38<03:19,  2.16it/s] 21%|██▏       | 116/545 [00:39<02:57,  2.41it/s] 21%|██▏       | 117/545 [00:39<02:42,  2.63it/s] 22%|██▏       | 118/545 [00:39<02:32,  2.79it/s] 22%|██▏       | 119/545 [00:39<02:25,  2.93it/s] 22%|██▏       | 120/545 [00:40<02:20,  3.02it/s]                                                  22%|██▏       | 120/545 [00:40<02:20,  3.02it/s] 22%|██▏       | 121/545 [00:40<02:16,  3.11it/s] 22%|██▏       | 122/545 [00:40<02:17,  3.08it/s] 23%|██▎       | 123/545 [00:41<02:14,  3.15it/s] 23%|██▎       | 124/545 [00:41<02:12,  3.19it/s] 23%|██▎       | 125/545 [00:41<02:11,  3.20it/s] 23%|██▎       | 126/545 [00:42<02:10,  3.22it/s] 23%|██▎       | 127/545 [00:42<02:09,  3.23it/s] 23%|██▎       | 128/545 [00:42<02:07,  3.26it/s] 24%|██▎       | 129/545 [00:43<02:07,  3.26it/s] 24%|██▍       | 130/545 [00:43<02:07,  3.26it/s]                                                  24%|██▍       | 130/545 [00:43<02:07,  3.26it/s] 24%|██▍       | 131/545 [00:43<02:06,  3.26it/s] 24%|██▍       | 132/545 [00:43<02:07,  3.25it/s] 24%|██▍       | 133/545 [00:44<02:06,  3.26it/s] 25%|██▍       | 134/545 [00:44<02:06,  3.26it/s] 25%|██▍       | 135/545 [00:44<02:05,  3.27it/s] 25%|██▍       | 136/545 [00:45<02:05,  3.26it/s] 25%|██▌       | 137/545 [00:45<02:04,  3.27it/s] 25%|██▌       | 138/545 [00:45<02:04,  3.27it/s] 26%|██▌       | 139/545 [00:46<02:04,  3.27it/s] 26%|██▌       | 140/545 [00:46<02:03,  3.27it/s]                                                  26%|██▌       | 140/545 [00:46<02:03,  3.27it/s] 26%|██▌       | 141/545 [00:46<02:03,  3.28it/s] 26%|██▌       | 142/545 [00:46<02:02,  3.29it/s] 26%|██▌       | 143/545 [00:47<02:02,  3.29it/s] 26%|██▋       | 144/545 [00:47<02:01,  3.29it/s] 27%|██▋       | 145/545 [00:47<02:01,  3.29it/s] 27%|██▋       | 146/545 [00:48<02:01,  3.29it/s] 27%|██▋       | 147/545 [00:48<02:00,  3.30it/s] 27%|██▋       | 148/545 [00:48<02:00,  3.29it/s] 27%|██▋       | 149/545 [00:49<02:00,  3.30it/s] 28%|██▊       | 150/545 [00:49<01:59,  3.30it/s]                                                  28%|██▊       | 150/545 [00:49<01:59,  3.30it/s] 28%|██▊       | 151/545 [00:49<02:00,  3.28it/s] 28%|██▊       | 152/545 [00:50<01:59,  3.30it/s] 28%|██▊       | 153/545 [00:50<01:54,  3.41it/s] 28%|██▊       | 154/545 [00:50<01:56,  3.37it/s] 28%|██▊       | 155/545 [00:50<01:56,  3.34it/s] 29%|██▊       | 156/545 [00:51<01:56,  3.33it/s] 29%|██▉       | 157/545 [00:51<01:56,  3.32it/s] 29%|██▉       | 158/545 [00:51<01:57,  3.30it/s] 29%|██▉       | 159/545 [00:52<01:56,  3.30it/s] 29%|██▉       | 160/545 [00:52<01:57,  3.29it/s]                                                  29%|██▉       | 160/545 [00:52<01:57,  3.29it/s] 30%|██▉       | 161/545 [00:52<01:57,  3.27it/s] 30%|██▉       | 162/545 [00:53<01:57,  3.27it/s] 30%|██▉       | 163/545 [00:53<01:56,  3.27it/s] 30%|███       | 164/545 [00:53<01:56,  3.28it/s] 30%|███       | 165/545 [00:53<01:56,  3.27it/s] 30%|███       | 166/545 [00:54<01:55,  3.27it/s] 31%|███       | 167/545 [00:54<01:55,  3.27it/s] 31%|███       | 168/545 [00:54<01:55,  3.27it/s] 31%|███       | 169/545 [00:55<01:54,  3.27it/s] 31%|███       | 170/545 [00:55<01:54,  3.27it/s]                                                  31%|███       | 170/545 [00:55<01:54,  3.27it/s] 31%|███▏      | 171/545 [00:55<01:53,  3.28it/s] 32%|███▏      | 172/545 [00:56<01:53,  3.28it/s] 32%|███▏      | 173/545 [00:56<01:52,  3.30it/s] 32%|███▏      | 174/545 [00:56<01:52,  3.30it/s] 32%|███▏      | 175/545 [00:57<01:52,  3.29it/s] 32%|███▏      | 176/545 [00:57<01:52,  3.29it/s] 32%|███▏      | 177/545 [00:57<01:52,  3.29it/s] 33%|███▎      | 178/545 [00:57<01:51,  3.29it/s] 33%|███▎      | 179/545 [00:58<01:51,  3.29it/s] 33%|███▎      | 180/545 [00:58<01:50,  3.30it/s]                                                  33%|███▎      | 180/545 [00:58<01:50,  3.30it/s] 33%|███▎      | 181/545 [00:58<01:50,  3.29it/s] 33%|███▎      | 182/545 [00:59<01:50,  3.28it/s] 34%|███▎      | 183/545 [00:59<01:50,  3.29it/s] 34%|███▍      | 184/545 [00:59<01:50,  3.27it/s] 34%|███▍      | 185/545 [01:00<01:49,  3.29it/s] 34%|███▍      | 186/545 [01:00<01:49,  3.28it/s] 34%|███▍      | 187/545 [01:00<01:49,  3.27it/s] 34%|███▍      | 188/545 [01:00<01:49,  3.26it/s] 35%|███▍      | 189/545 [01:01<01:49,  3.25it/s] 35%|███▍      | 190/545 [01:01<01:48,  3.27it/s]                                                  35%|███▍      | 190/545 [01:01<01:48,  3.27it/s] 35%|███▌      | 191/545 [01:01<01:48,  3.26it/s] 35%|███▌      | 192/545 [01:02<01:47,  3.27it/s] 35%|███▌      | 193/545 [01:02<01:47,  3.28it/s] 36%|███▌      | 194/545 [01:02<01:46,  3.28it/s] 36%|███▌      | 195/545 [01:03<01:46,  3.28it/s] 36%|███▌      | 196/545 [01:03<01:46,  3.29it/s] 36%|███▌      | 197/545 [01:03<01:46,  3.28it/s] 36%|███▋      | 198/545 [01:04<01:46,  3.27it/s] 37%|███▋      | 199/545 [01:04<01:45,  3.29it/s] 37%|███▋      | 200/545 [01:04<01:45,  3.28it/s]                                                  37%|███▋      | 200/545 [01:04<01:45,  3.28it/s] 37%|███▋      | 201/545 [01:04<01:44,  3.29it/s] 37%|███▋      | 202/545 [01:05<01:44,  3.29it/s] 37%|███▋      | 203/545 [01:05<01:44,  3.27it/s] 37%|███▋      | 204/545 [01:05<01:44,  3.27it/s] 38%|███▊      | 205/545 [01:06<01:43,  3.28it/s] 38%|███▊      | 206/545 [01:06<01:43,  3.28it/s] 38%|███▊      | 207/545 [01:06<01:42,  3.29it/s] 38%|███▊      | 208/545 [01:07<01:42,  3.28it/s] 38%|███▊      | 209/545 [01:07<01:41,  3.30it/s] 39%|███▊      | 210/545 [01:07<01:41,  3.29it/s]                                                  39%|███▊      | 210/545 [01:07<01:41,  3.29it/s] 39%|███▊      | 211/545 [01:07<01:41,  3.28it/s] 39%|███▉      | 212/545 [01:08<01:41,  3.29it/s] 39%|███▉      | 213/545 [01:08<01:41,  3.29it/s] 39%|███▉      | 214/545 [01:08<01:40,  3.29it/s] 39%|███▉      | 215/545 [01:09<01:40,  3.28it/s] 40%|███▉      | 216/545 [01:09<01:40,  3.28it/s] 40%|███▉      | 217/545 [01:09<01:40,  3.27it/s] 40%|████      | 218/545 [01:10<01:39,  3.29it/s]{'eval_loss': 1.0325069427490234, 'eval_runtime': 1.2384, 'eval_samples_per_second': 31.493, 'eval_steps_per_second': 31.493, 'eval_mean_token_accuracy': 0.7646431279182434, 'epoch': 1.0}
{'loss': 1.0654, 'grad_norm': 0.10730569809675217, 'learning_rate': 0.00016, 'mean_token_accuracy': 0.7790609151124954, 'epoch': 1.01}
{'loss': 0.9497, 'grad_norm': 0.11928744614124298, 'learning_rate': 0.00015633027522935782, 'mean_token_accuracy': 0.7832913115620613, 'epoch': 1.1}
{'loss': 0.9671, 'grad_norm': 0.11256856471300125, 'learning_rate': 0.0001526605504587156, 'mean_token_accuracy': 0.7786889284849167, 'epoch': 1.19}
{'loss': 0.9384, 'grad_norm': 0.11855363100767136, 'learning_rate': 0.0001489908256880734, 'mean_token_accuracy': 0.7874616339802742, 'epoch': 1.28}
{'loss': 0.9564, 'grad_norm': 0.11230889707803726, 'learning_rate': 0.00014532110091743122, 'mean_token_accuracy': 0.7829347297549247, 'epoch': 1.38}
{'loss': 0.9581, 'grad_norm': 0.12582165002822876, 'learning_rate': 0.000141651376146789, 'mean_token_accuracy': 0.7792316138744354, 'epoch': 1.47}
{'loss': 0.9631, 'grad_norm': 0.13074755668640137, 'learning_rate': 0.0001379816513761468, 'mean_token_accuracy': 0.7823170766234397, 'epoch': 1.56}
{'loss': 0.9688, 'grad_norm': 0.12409766763448715, 'learning_rate': 0.00013431192660550461, 'mean_token_accuracy': 0.7815146595239639, 'epoch': 1.65}
{'loss': 0.9529, 'grad_norm': 0.13009347021579742, 'learning_rate': 0.0001306422018348624, 'mean_token_accuracy': 0.7828512534499168, 'epoch': 1.74}
{'loss': 0.9506, 'grad_norm': 0.12864144146442413, 'learning_rate': 0.0001269724770642202, 'mean_token_accuracy': 0.7855010569095612, 'epoch': 1.83}
{'loss': 0.9507, 'grad_norm': 0.13453362882137299, 'learning_rate': 0.00012330275229357798, 'mean_token_accuracy': 0.7831024289131164, 'epoch': 1.93}

  0%|          | 0/39 [00:00<?, ?it/s][A
 13%|█▎        | 5/39 [00:00<00:00, 39.44it/s][A
 23%|██▎       | 9/39 [00:00<00:00, 34.51it/s][A
 33%|███▎      | 13/39 [00:00<00:00, 33.10it/s][A
 44%|████▎     | 17/39 [00:00<00:00, 32.59it/s][A
 54%|█████▍    | 21/39 [00:00<00:00, 32.23it/s][A
 64%|██████▍   | 25/39 [00:00<00:00, 32.18it/s][A
 74%|███████▍  | 29/39 [00:00<00:00, 32.08it/s][A
 85%|████████▍ | 33/39 [00:01<00:00, 31.83it/s][A
 95%|█████████▍| 37/39 [00:01<00:00, 31.72it/s][A                                                 
                                               [A 40%|████      | 218/545 [01:11<01:39,  3.29it/s]
100%|██████████| 39/39 [00:01<00:00, 31.72it/s][A
                                               [A 40%|████      | 219/545 [01:13<06:44,  1.24s/it] 40%|████      | 220/545 [01:13<05:12,  1.04it/s]                                                  40%|████      | 220/545 [01:13<05:12,  1.04it/s] 41%|████      | 221/545 [01:14<04:07,  1.31it/s] 41%|████      | 222/545 [01:14<03:21,  1.60it/s] 41%|████      | 223/545 [01:14<02:50,  1.89it/s] 41%|████      | 224/545 [01:15<02:27,  2.17it/s] 41%|████▏     | 225/545 [01:15<02:12,  2.42it/s] 41%|████▏     | 226/545 [01:15<02:01,  2.63it/s] 42%|████▏     | 227/545 [01:15<01:53,  2.79it/s] 42%|████▏     | 228/545 [01:16<01:48,  2.92it/s] 42%|████▏     | 229/545 [01:16<01:44,  3.03it/s] 42%|████▏     | 230/545 [01:16<01:41,  3.11it/s]                                                  42%|████▏     | 230/545 [01:16<01:41,  3.11it/s] 42%|████▏     | 231/545 [01:17<01:39,  3.14it/s] 43%|████▎     | 232/545 [01:17<01:38,  3.19it/s] 43%|████▎     | 233/545 [01:17<01:37,  3.21it/s] 43%|████▎     | 234/545 [01:18<01:36,  3.23it/s] 43%|████▎     | 235/545 [01:18<01:35,  3.25it/s] 43%|████▎     | 236/545 [01:18<01:34,  3.26it/s] 43%|████▎     | 237/545 [01:19<01:34,  3.27it/s] 44%|████▎     | 238/545 [01:19<01:34,  3.26it/s] 44%|████▍     | 239/545 [01:19<01:33,  3.28it/s] 44%|████▍     | 240/545 [01:19<01:32,  3.28it/s]                                                  44%|████▍     | 240/545 [01:19<01:32,  3.28it/s] 44%|████▍     | 241/545 [01:20<01:32,  3.28it/s] 44%|████▍     | 242/545 [01:20<01:32,  3.27it/s] 45%|████▍     | 243/545 [01:20<01:32,  3.27it/s] 45%|████▍     | 244/545 [01:21<01:32,  3.27it/s] 45%|████▍     | 245/545 [01:21<01:31,  3.27it/s] 45%|████▌     | 246/545 [01:21<01:31,  3.28it/s] 45%|████▌     | 247/545 [01:22<01:30,  3.28it/s] 46%|████▌     | 248/545 [01:22<01:30,  3.29it/s] 46%|████▌     | 249/545 [01:22<01:30,  3.28it/s] 46%|████▌     | 250/545 [01:22<01:29,  3.29it/s]                                                  46%|████▌     | 250/545 [01:22<01:29,  3.29it/s] 46%|████▌     | 251/545 [01:23<01:29,  3.30it/s] 46%|████▌     | 252/545 [01:23<01:28,  3.29it/s] 46%|████▋     | 253/545 [01:23<01:29,  3.28it/s] 47%|████▋     | 254/545 [01:24<01:28,  3.28it/s] 47%|████▋     | 255/545 [01:24<01:27,  3.30it/s] 47%|████▋     | 256/545 [01:24<01:27,  3.29it/s] 47%|████▋     | 257/545 [01:25<01:27,  3.30it/s] 47%|████▋     | 258/545 [01:25<01:27,  3.30it/s] 48%|████▊     | 259/545 [01:25<01:26,  3.30it/s] 48%|████▊     | 260/545 [01:26<01:26,  3.28it/s]                                                  48%|████▊     | 260/545 [01:26<01:26,  3.28it/s] 48%|████▊     | 261/545 [01:26<01:26,  3.28it/s] 48%|████▊     | 262/545 [01:26<01:26,  3.29it/s] 48%|████▊     | 263/545 [01:26<01:25,  3.28it/s] 48%|████▊     | 264/545 [01:27<01:25,  3.29it/s] 49%|████▊     | 265/545 [01:27<01:25,  3.29it/s] 49%|████▉     | 266/545 [01:27<01:24,  3.28it/s] 49%|████▉     | 267/545 [01:28<01:24,  3.28it/s] 49%|████▉     | 268/545 [01:28<01:24,  3.27it/s] 49%|████▉     | 269/545 [01:28<01:24,  3.27it/s] 50%|████▉     | 270/545 [01:29<01:23,  3.29it/s]                                                  50%|████▉     | 270/545 [01:29<01:23,  3.29it/s] 50%|████▉     | 271/545 [01:29<01:23,  3.27it/s] 50%|████▉     | 272/545 [01:29<01:23,  3.28it/s] 50%|█████     | 273/545 [01:29<01:23,  3.27it/s] 50%|█████     | 274/545 [01:30<01:22,  3.27it/s] 50%|█████     | 275/545 [01:30<01:22,  3.26it/s] 51%|█████     | 276/545 [01:30<01:22,  3.27it/s] 51%|█████     | 277/545 [01:31<01:21,  3.28it/s] 51%|█████     | 278/545 [01:31<01:21,  3.29it/s] 51%|█████     | 279/545 [01:31<01:20,  3.29it/s] 51%|█████▏    | 280/545 [01:32<01:21,  3.27it/s]                                                  51%|█████▏    | 280/545 [01:32<01:21,  3.27it/s] 52%|█████▏    | 281/545 [01:32<01:20,  3.27it/s] 52%|█████▏    | 282/545 [01:32<01:20,  3.27it/s] 52%|█████▏    | 283/545 [01:33<01:20,  3.27it/s] 52%|█████▏    | 284/545 [01:33<01:19,  3.29it/s] 52%|█████▏    | 285/545 [01:33<01:18,  3.29it/s] 52%|█████▏    | 286/545 [01:33<01:18,  3.30it/s] 53%|█████▎    | 287/545 [01:34<01:18,  3.29it/s] 53%|█████▎    | 288/545 [01:34<01:18,  3.28it/s] 53%|█████▎    | 289/545 [01:34<01:18,  3.28it/s] 53%|█████▎    | 290/545 [01:35<01:17,  3.29it/s]                                                  53%|█████▎    | 290/545 [01:35<01:17,  3.29it/s] 53%|█████▎    | 291/545 [01:35<01:17,  3.29it/s] 54%|█████▎    | 292/545 [01:35<01:17,  3.28it/s] 54%|█████▍    | 293/545 [01:36<01:16,  3.28it/s] 54%|█████▍    | 294/545 [01:36<01:16,  3.28it/s] 54%|█████▍    | 295/545 [01:36<01:16,  3.27it/s] 54%|█████▍    | 296/545 [01:36<01:16,  3.28it/s] 54%|█████▍    | 297/545 [01:37<01:15,  3.28it/s] 55%|█████▍    | 298/545 [01:37<01:15,  3.29it/s] 55%|█████▍    | 299/545 [01:37<01:15,  3.27it/s] 55%|█████▌    | 300/545 [01:38<01:14,  3.28it/s]                                                  55%|█████▌    | 300/545 [01:38<01:14,  3.28it/s] 55%|█████▌    | 301/545 [01:38<01:14,  3.27it/s] 55%|█████▌    | 302/545 [01:38<01:14,  3.27it/s] 56%|█████▌    | 303/545 [01:39<01:14,  3.27it/s] 56%|█████▌    | 304/545 [01:39<01:13,  3.28it/s] 56%|█████▌    | 305/545 [01:39<01:12,  3.29it/s] 56%|█████▌    | 306/545 [01:40<01:12,  3.29it/s] 56%|█████▋    | 307/545 [01:40<01:12,  3.30it/s] 57%|█████▋    | 308/545 [01:40<01:11,  3.30it/s] 57%|█████▋    | 309/545 [01:40<01:11,  3.30it/s] 57%|█████▋    | 310/545 [01:41<01:11,  3.31it/s]                                                  57%|█████▋    | 310/545 [01:41<01:11,  3.31it/s] 57%|█████▋    | 311/545 [01:41<01:11,  3.29it/s] 57%|█████▋    | 312/545 [01:41<01:10,  3.28it/s] 57%|█████▋    | 313/545 [01:42<01:08,  3.39it/s] 58%|█████▊    | 314/545 [01:42<01:08,  3.35it/s] 58%|█████▊    | 315/545 [01:42<01:08,  3.34it/s] 58%|█████▊    | 316/545 [01:43<01:08,  3.32it/s] 58%|█████▊    | 317/545 [01:43<01:09,  3.30it/s] 58%|█████▊    | 318/545 [01:43<01:08,  3.29it/s] 59%|█████▊    | 319/545 [01:43<01:08,  3.28it/s] 59%|█████▊    | 320/545 [01:44<01:08,  3.27it/s]                                                  59%|█████▊    | 320/545 [01:44<01:08,  3.27it/s] 59%|█████▉    | 321/545 [01:44<01:08,  3.26it/s] 59%|█████▉    | 322/545 [01:44<01:08,  3.27it/s] 59%|█████▉    | 323/545 [01:45<01:07,  3.27it/s] 59%|█████▉    | 324/545 [01:45<01:07,  3.27it/s] 60%|█████▉    | 325/545 [01:45<01:07,  3.27it/s] 60%|█████▉    | 326/545 [01:46<01:06,  3.28it/s] 60%|██████    | 327/545 [01:46<01:06,  3.27it/s]{'eval_loss': 1.0153846740722656, 'eval_runtime': 1.2294, 'eval_samples_per_second': 31.723, 'eval_steps_per_second': 31.723, 'eval_mean_token_accuracy': 0.7730452048946435, 'epoch': 2.0}
{'loss': 0.9411, 'grad_norm': 0.12358200550079346, 'learning_rate': 0.00011963302752293579, 'mean_token_accuracy': 0.7977980822324753, 'epoch': 2.02}
{'loss': 0.8471, 'grad_norm': 0.13252365589141846, 'learning_rate': 0.00011596330275229359, 'mean_token_accuracy': 0.8007784977555275, 'epoch': 2.11}
{'loss': 0.8798, 'grad_norm': 0.15005318820476532, 'learning_rate': 0.0001122935779816514, 'mean_token_accuracy': 0.7906301349401474, 'epoch': 2.2}
{'loss': 0.844, 'grad_norm': 0.16380397975444794, 'learning_rate': 0.00010862385321100919, 'mean_token_accuracy': 0.7993670523166656, 'epoch': 2.29}
{'loss': 0.81, 'grad_norm': 0.15145808458328247, 'learning_rate': 0.00010495412844036698, 'mean_token_accuracy': 0.806393352150917, 'epoch': 2.39}
{'loss': 0.8696, 'grad_norm': 0.17826195061206818, 'learning_rate': 0.00010128440366972478, 'mean_token_accuracy': 0.7967795133590698, 'epoch': 2.48}
{'loss': 0.8869, 'grad_norm': 0.17167432606220245, 'learning_rate': 9.761467889908259e-05, 'mean_token_accuracy': 0.7935547322034836, 'epoch': 2.57}
{'loss': 0.8667, 'grad_norm': 0.17608143389225006, 'learning_rate': 9.394495412844038e-05, 'mean_token_accuracy': 0.7952433720231056, 'epoch': 2.66}
{'loss': 0.8653, 'grad_norm': 0.1717386245727539, 'learning_rate': 9.027522935779817e-05, 'mean_token_accuracy': 0.7967027559876442, 'epoch': 2.75}
{'loss': 0.8344, 'grad_norm': 0.17623744904994965, 'learning_rate': 8.660550458715597e-05, 'mean_token_accuracy': 0.8006321504712105, 'epoch': 2.84}
{'loss': 0.8797, 'grad_norm': 0.17792046070098877, 'learning_rate': 8.293577981651378e-05, 'mean_token_accuracy': 0.7961628690361977, 'epoch': 2.94}

  0%|          | 0/39 [00:00<?, ?it/s][A
 13%|█▎        | 5/39 [00:00<00:00, 38.76it/s][A
 23%|██▎       | 9/39 [00:00<00:00, 34.57it/s][A
 33%|███▎      | 13/39 [00:00<00:00, 32.86it/s][A
 44%|████▎     | 17/39 [00:00<00:00, 32.00it/s][A
 54%|█████▍    | 21/39 [00:00<00:00, 31.65it/s][A
 64%|██████▍   | 25/39 [00:00<00:00, 31.55it/s][A
 74%|███████▍  | 29/39 [00:00<00:00, 31.53it/s][A
 85%|████████▍ | 33/39 [00:01<00:00, 31.53it/s][A
 95%|█████████▍| 37/39 [00:01<00:00, 31.53it/s][A                                                 
                                               [A 60%|██████    | 327/545 [01:47<01:06,  3.27it/s]
100%|██████████| 39/39 [00:01<00:00, 31.53it/s][A
                                               [A 60%|██████    | 328/545 [01:49<04:29,  1.24s/it] 60%|██████    | 329/545 [01:50<03:27,  1.04it/s] 61%|██████    | 330/545 [01:50<02:44,  1.31it/s]                                                  61%|██████    | 330/545 [01:50<02:44,  1.31it/s] 61%|██████    | 331/545 [01:50<02:13,  1.60it/s] 61%|██████    | 332/545 [01:51<01:53,  1.87it/s] 61%|██████    | 333/545 [01:51<01:38,  2.15it/s] 61%|██████▏   | 334/545 [01:51<01:27,  2.40it/s] 61%|██████▏   | 335/545 [01:51<01:20,  2.60it/s] 62%|██████▏   | 336/545 [01:52<01:13,  2.84it/s] 62%|██████▏   | 337/545 [01:52<01:10,  2.95it/s] 62%|██████▏   | 338/545 [01:52<01:08,  3.04it/s] 62%|██████▏   | 339/545 [01:53<01:06,  3.10it/s] 62%|██████▏   | 340/545 [01:53<01:04,  3.16it/s]                                                  62%|██████▏   | 340/545 [01:53<01:04,  3.16it/s] 63%|██████▎   | 341/545 [01:53<01:03,  3.19it/s] 63%|██████▎   | 342/545 [01:54<01:02,  3.22it/s] 63%|██████▎   | 343/545 [01:54<01:02,  3.23it/s] 63%|██████▎   | 344/545 [01:54<01:02,  3.24it/s] 63%|██████▎   | 345/545 [01:55<01:01,  3.24it/s] 63%|██████▎   | 346/545 [01:55<01:01,  3.24it/s] 64%|██████▎   | 347/545 [01:55<01:00,  3.26it/s] 64%|██████▍   | 348/545 [01:55<01:00,  3.25it/s] 64%|██████▍   | 349/545 [01:56<01:00,  3.26it/s] 64%|██████▍   | 350/545 [01:56<00:59,  3.25it/s]                                                  64%|██████▍   | 350/545 [01:56<00:59,  3.25it/s] 64%|██████▍   | 351/545 [01:56<00:59,  3.26it/s] 65%|██████▍   | 352/545 [01:57<00:59,  3.27it/s] 65%|██████▍   | 353/545 [01:57<00:58,  3.29it/s] 65%|██████▍   | 354/545 [01:57<00:57,  3.30it/s] 65%|██████▌   | 355/545 [01:58<00:57,  3.30it/s] 65%|██████▌   | 356/545 [01:58<00:57,  3.30it/s] 66%|██████▌   | 357/545 [01:58<00:57,  3.29it/s] 66%|██████▌   | 358/545 [01:58<00:56,  3.30it/s] 66%|██████▌   | 359/545 [01:59<00:56,  3.30it/s] 66%|██████▌   | 360/545 [01:59<00:56,  3.29it/s]                                                  66%|██████▌   | 360/545 [01:59<00:56,  3.29it/s] 66%|██████▌   | 361/545 [01:59<00:55,  3.29it/s] 66%|██████▋   | 362/545 [02:00<00:55,  3.29it/s] 67%|██████▋   | 363/545 [02:00<00:55,  3.29it/s] 67%|██████▋   | 364/545 [02:00<00:55,  3.29it/s] 67%|██████▋   | 365/545 [02:01<00:54,  3.28it/s] 67%|██████▋   | 366/545 [02:01<00:54,  3.29it/s] 67%|██████▋   | 367/545 [02:01<00:54,  3.28it/s] 68%|██████▊   | 368/545 [02:02<00:53,  3.29it/s] 68%|██████▊   | 369/545 [02:02<00:53,  3.28it/s] 68%|██████▊   | 370/545 [02:02<00:53,  3.27it/s]                                                  68%|██████▊   | 370/545 [02:02<00:53,  3.27it/s] 68%|██████▊   | 371/545 [02:02<00:53,  3.25it/s] 68%|██████▊   | 372/545 [02:03<00:52,  3.27it/s] 68%|██████▊   | 373/545 [02:03<00:52,  3.26it/s] 69%|██████▊   | 374/545 [02:03<00:52,  3.26it/s] 69%|██████▉   | 375/545 [02:04<00:52,  3.27it/s] 69%|██████▉   | 376/545 [02:04<00:51,  3.27it/s] 69%|██████▉   | 377/545 [02:04<00:51,  3.27it/s] 69%|██████▉   | 378/545 [02:05<00:51,  3.27it/s] 70%|██████▉   | 379/545 [02:05<00:50,  3.26it/s] 70%|██████▉   | 380/545 [02:05<00:50,  3.28it/s]                                                  70%|██████▉   | 380/545 [02:05<00:50,  3.28it/s] 70%|██████▉   | 381/545 [02:06<00:50,  3.27it/s] 70%|███████   | 382/545 [02:06<00:49,  3.29it/s] 70%|███████   | 383/545 [02:06<00:49,  3.29it/s] 70%|███████   | 384/545 [02:06<00:48,  3.29it/s] 71%|███████   | 385/545 [02:07<00:48,  3.29it/s] 71%|███████   | 386/545 [02:07<00:48,  3.28it/s] 71%|███████   | 387/545 [02:07<00:48,  3.28it/s] 71%|███████   | 388/545 [02:08<00:47,  3.29it/s] 71%|███████▏  | 389/545 [02:08<00:47,  3.28it/s] 72%|███████▏  | 390/545 [02:08<00:47,  3.27it/s]                                                  72%|███████▏  | 390/545 [02:08<00:47,  3.27it/s] 72%|███████▏  | 391/545 [02:09<00:47,  3.27it/s] 72%|███████▏  | 392/545 [02:09<00:46,  3.28it/s] 72%|███████▏  | 393/545 [02:09<00:46,  3.27it/s] 72%|███████▏  | 394/545 [02:09<00:46,  3.28it/s] 72%|███████▏  | 395/545 [02:10<00:45,  3.27it/s] 73%|███████▎  | 396/545 [02:10<00:45,  3.26it/s] 73%|███████▎  | 397/545 [02:10<00:45,  3.27it/s] 73%|███████▎  | 398/545 [02:11<00:44,  3.27it/s] 73%|███████▎  | 399/545 [02:11<00:44,  3.26it/s] 73%|███████▎  | 400/545 [02:11<00:44,  3.25it/s]                                                  73%|███████▎  | 400/545 [02:11<00:44,  3.25it/s] 74%|███████▎  | 401/545 [02:12<00:44,  3.27it/s] 74%|███████▍  | 402/545 [02:12<00:43,  3.26it/s] 74%|███████▍  | 403/545 [02:12<00:43,  3.25it/s] 74%|███████▍  | 404/545 [02:13<00:43,  3.25it/s] 74%|███████▍  | 405/545 [02:13<00:42,  3.26it/s] 74%|███████▍  | 406/545 [02:13<00:42,  3.27it/s] 75%|███████▍  | 407/545 [02:13<00:42,  3.26it/s] 75%|███████▍  | 408/545 [02:14<00:41,  3.27it/s] 75%|███████▌  | 409/545 [02:14<00:41,  3.27it/s] 75%|███████▌  | 410/545 [02:14<00:41,  3.27it/s]                                                  75%|███████▌  | 410/545 [02:14<00:41,  3.27it/s] 75%|███████▌  | 411/545 [02:15<00:40,  3.27it/s] 76%|███████▌  | 412/545 [02:15<00:40,  3.28it/s] 76%|███████▌  | 413/545 [02:15<00:40,  3.28it/s] 76%|███████▌  | 414/545 [02:16<00:39,  3.28it/s] 76%|███████▌  | 415/545 [02:16<00:39,  3.29it/s] 76%|███████▋  | 416/545 [02:16<00:39,  3.29it/s] 77%|███████▋  | 417/545 [02:17<00:38,  3.29it/s] 77%|███████▋  | 418/545 [02:17<00:38,  3.30it/s] 77%|███████▋  | 419/545 [02:17<00:38,  3.29it/s] 77%|███████▋  | 420/545 [02:17<00:37,  3.29it/s]                                                  77%|███████▋  | 420/545 [02:17<00:37,  3.29it/s] 77%|███████▋  | 421/545 [02:18<00:37,  3.27it/s] 77%|███████▋  | 422/545 [02:18<00:37,  3.24it/s] 78%|███████▊  | 423/545 [02:18<00:37,  3.22it/s] 78%|███████▊  | 424/545 [02:19<00:37,  3.19it/s] 78%|███████▊  | 425/545 [02:19<00:37,  3.19it/s] 78%|███████▊  | 426/545 [02:19<00:37,  3.21it/s] 78%|███████▊  | 427/545 [02:20<00:36,  3.23it/s] 79%|███████▊  | 428/545 [02:20<00:36,  3.24it/s] 79%|███████▊  | 429/545 [02:20<00:36,  3.22it/s] 79%|███████▉  | 430/545 [02:21<00:35,  3.24it/s]                                                  79%|███████▉  | 430/545 [02:21<00:35,  3.24it/s] 79%|███████▉  | 431/545 [02:21<00:35,  3.26it/s] 79%|███████▉  | 432/545 [02:21<00:34,  3.26it/s] 79%|███████▉  | 433/545 [02:21<00:34,  3.27it/s] 80%|███████▉  | 434/545 [02:22<00:34,  3.24it/s] 80%|███████▉  | 435/545 [02:22<00:33,  3.25it/s] 80%|████████  | 436/545 [02:22<00:33,  3.25it/s]{'eval_loss': 1.0356743335723877, 'eval_runtime': 1.2415, 'eval_samples_per_second': 31.415, 'eval_steps_per_second': 31.415, 'eval_mean_token_accuracy': 0.781922306587447, 'epoch': 3.0}
{'loss': 0.8064, 'grad_norm': 0.15965837240219116, 'learning_rate': 7.926605504587157e-05, 'mean_token_accuracy': 0.8198298414548238, 'epoch': 3.03}
{'loss': 0.727, 'grad_norm': 0.2030729055404663, 'learning_rate': 7.559633027522937e-05, 'mean_token_accuracy': 0.8236451402306557, 'epoch': 3.12}
{'loss': 0.7491, 'grad_norm': 0.19846148788928986, 'learning_rate': 7.192660550458716e-05, 'mean_token_accuracy': 0.8194250628352165, 'epoch': 3.21}
{'loss': 0.7602, 'grad_norm': 0.21823322772979736, 'learning_rate': 6.825688073394497e-05, 'mean_token_accuracy': 0.8149038255214691, 'epoch': 3.3}
{'loss': 0.7663, 'grad_norm': 0.20969156920909882, 'learning_rate': 6.458715596330276e-05, 'mean_token_accuracy': 0.8135407820343972, 'epoch': 3.39}
{'loss': 0.7442, 'grad_norm': 0.23595406115055084, 'learning_rate': 6.0917431192660556e-05, 'mean_token_accuracy': 0.8196733847260476, 'epoch': 3.49}
{'loss': 0.7706, 'grad_norm': 0.20780013501644135, 'learning_rate': 5.724770642201836e-05, 'mean_token_accuracy': 0.8126510262489319, 'epoch': 3.58}
{'loss': 0.7301, 'grad_norm': 0.226496621966362, 'learning_rate': 5.357798165137615e-05, 'mean_token_accuracy': 0.8199569389224053, 'epoch': 3.67}
{'loss': 0.7557, 'grad_norm': 0.20878475904464722, 'learning_rate': 4.990825688073395e-05, 'mean_token_accuracy': 0.8190138041973114, 'epoch': 3.76}
{'loss': 0.7539, 'grad_norm': 0.22923947870731354, 'learning_rate': 4.623853211009175e-05, 'mean_token_accuracy': 0.8126403316855431, 'epoch': 3.85}
{'loss': 0.7758, 'grad_norm': 0.2374006062746048, 'learning_rate': 4.256880733944955e-05, 'mean_token_accuracy': 0.8117453202605247, 'epoch': 3.94}

  0%|          | 0/39 [00:00<?, ?it/s][A
 13%|█▎        | 5/39 [00:00<00:00, 39.74it/s][A
 23%|██▎       | 9/39 [00:00<00:00, 35.50it/s][A
 33%|███▎      | 13/39 [00:00<00:00, 33.70it/s][A
 44%|████▎     | 17/39 [00:00<00:00, 32.81it/s][A
 54%|█████▍    | 21/39 [00:00<00:00, 32.24it/s][A
 64%|██████▍   | 25/39 [00:00<00:00, 31.96it/s][A
 74%|███████▍  | 29/39 [00:00<00:00, 31.95it/s][A
 85%|████████▍ | 33/39 [00:01<00:00, 32.10it/s][A
 95%|█████████▍| 37/39 [00:01<00:00, 31.92it/s][A                                                 
                                               [A 80%|████████  | 436/545 [02:24<00:33,  3.25it/s]
100%|██████████| 39/39 [00:01<00:00, 31.92it/s][A
                                               [A                                                  80%|████████  | 436/545 [02:26<00:33,  3.25it/s] 80%|████████  | 436/545 [02:26<00:36,  2.98it/s]
{'eval_loss': 1.0810134410858154, 'eval_runtime': 1.2242, 'eval_samples_per_second': 31.859, 'eval_steps_per_second': 31.859, 'eval_mean_token_accuracy': 0.7819837606142438, 'epoch': 4.0}
{'train_runtime': 147.3823, 'train_samples_per_second': 14.791, 'train_steps_per_second': 3.698, 'train_loss': 0.9447970280953504, 'epoch': 4.0}
✓ Metrics saved to: ./results/llama-arc-lora-all/metrics_lora-all.json
[1;34mwandb[0m: 🚀 View run [33mpretty-voice-42[0m at: [34mhttps://wandb.ai/waynehacking8-national-taiwan-university-of-science-and-/huggingface/runs/mgvftn2u[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20251012_154624-mgvftn2u/logs[0m
✓ Experiment 2 completed

========================================
Experiment 3/3: llama-arc-fullft
========================================
Model: meta-llama/Llama-3.2-1B-Instruct
Dataset: allenai/ai2_arc (ARC-Easy)
Method: fullft
Max seq length: 512
Output: ./results/llama-arc-fullft

/home/wayneleo8/lora_without_regret/sft_compare.py:222: FutureWarning: `tokenizer` is deprecated and removed starting from version 0.16.0 for `SFTTrainer.__init__`. Use `processing_class` instead.
  trainer = SFTTrainer(
The model is already on multiple devices. Skipping the move to device specified in `args`.
The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'eos_token_id': 128009, 'pad_token_id': 128009}.
wandb: Using wandb-core as the SDK backend. Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: waynehacking8 (waynehacking8-national-taiwan-university-of-science-and-). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.18.3
wandb: Run data is saved locally in /home/wayneleo8/lora_without_regret/wandb/run-20251012_154903-kn41xb2c
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run amber-yogurt-43
wandb: ⭐️ View project at https://wandb.ai/waynehacking8-national-taiwan-university-of-science-and-/huggingface
wandb: 🚀 View run at https://wandb.ai/waynehacking8-national-taiwan-university-of-science-and-/huggingface/runs/kn41xb2c
Training samples: 2251
Validation samples: 200

============================================================
Training Configuration:
  Method: FULLFT
  Learning Rate: 2e-05
  Epochs: 5
  Early Stopping Patience: 2 epochs
  Batch Size: 1 x 4 = 4
============================================================

  0%|          | 0/545 [00:00<?, ?it/s]  0%|          | 1/545 [00:00<05:01,  1.81it/s]  0%|          | 2/545 [00:00<04:02,  2.24it/s]  1%|          | 3/545 [00:01<03:46,  2.39it/s]  1%|          | 4/545 [00:01<03:39,  2.47it/s]  1%|          | 5/545 [00:02<03:35,  2.51it/s]  1%|          | 6/545 [00:02<03:32,  2.53it/s]  1%|▏         | 7/545 [00:02<03:31,  2.54it/s]  1%|▏         | 8/545 [00:03<03:33,  2.51it/s]  2%|▏         | 9/545 [00:03<03:32,  2.53it/s]  2%|▏         | 10/545 [00:04<03:31,  2.53it/s]                                                  2%|▏         | 10/545 [00:04<03:31,  2.53it/s]  2%|▏         | 11/545 [00:04<03:31,  2.53it/s]  2%|▏         | 12/545 [00:04<03:31,  2.52it/s]  2%|▏         | 13/545 [00:05<03:32,  2.51it/s]  3%|▎         | 14/545 [00:05<03:32,  2.50it/s]  3%|▎         | 15/545 [00:06<03:30,  2.52it/s]  3%|▎         | 16/545 [00:06<03:28,  2.54it/s]  3%|▎         | 17/545 [00:06<03:26,  2.56it/s]  3%|▎         | 18/545 [00:07<03:25,  2.56it/s]  3%|▎         | 19/545 [00:07<03:24,  2.57it/s]  4%|▎         | 20/545 [00:07<03:24,  2.56it/s]                                                  4%|▎         | 20/545 [00:08<03:24,  2.56it/s]  4%|▍         | 21/545 [00:08<03:25,  2.55it/s]  4%|▍         | 22/545 [00:08<03:24,  2.55it/s]  4%|▍         | 23/545 [00:09<03:24,  2.56it/s]  4%|▍         | 24/545 [00:09<03:23,  2.56it/s]  5%|▍         | 25/545 [00:09<03:23,  2.55it/s]  5%|▍         | 26/545 [00:10<03:23,  2.55it/s]  5%|▍         | 27/545 [00:10<03:24,  2.54it/s]  5%|▌         | 28/545 [00:11<03:22,  2.55it/s]  5%|▌         | 29/545 [00:11<03:21,  2.56it/s]  6%|▌         | 30/545 [00:11<03:21,  2.56it/s]                                                  6%|▌         | 30/545 [00:11<03:21,  2.56it/s]  6%|▌         | 31/545 [00:12<03:22,  2.54it/s]  6%|▌         | 32/545 [00:12<03:20,  2.55it/s]  6%|▌         | 33/545 [00:13<03:19,  2.57it/s]  6%|▌         | 34/545 [00:13<03:21,  2.53it/s]  6%|▋         | 35/545 [00:13<03:21,  2.53it/s]  7%|▋         | 36/545 [00:14<03:21,  2.52it/s]  7%|▋         | 37/545 [00:14<03:22,  2.51it/s]  7%|▋         | 38/545 [00:15<03:22,  2.50it/s]  7%|▋         | 39/545 [00:15<03:21,  2.51it/s]  7%|▋         | 40/545 [00:15<03:19,  2.53it/s]                                                  7%|▋         | 40/545 [00:15<03:19,  2.53it/s]  8%|▊         | 41/545 [00:16<03:19,  2.53it/s]  8%|▊         | 42/545 [00:16<03:18,  2.54it/s]  8%|▊         | 43/545 [00:17<03:16,  2.56it/s]  8%|▊         | 44/545 [00:17<03:15,  2.56it/s]  8%|▊         | 45/545 [00:17<03:15,  2.55it/s]  8%|▊         | 46/545 [00:18<03:15,  2.56it/s]  9%|▊         | 47/545 [00:18<03:14,  2.56it/s]  9%|▉         | 48/545 [00:18<03:13,  2.57it/s]  9%|▉         | 49/545 [00:19<03:12,  2.57it/s]  9%|▉         | 50/545 [00:19<03:12,  2.57it/s]                                                  9%|▉         | 50/545 [00:19<03:12,  2.57it/s]  9%|▉         | 51/545 [00:20<03:11,  2.57it/s] 10%|▉         | 52/545 [00:20<03:11,  2.58it/s] 10%|▉         | 53/545 [00:20<03:10,  2.58it/s] 10%|▉         | 54/545 [00:21<03:12,  2.55it/s] 10%|█         | 55/545 [00:21<03:11,  2.56it/s] 10%|█         | 56/545 [00:22<03:10,  2.57it/s] 10%|█         | 57/545 [00:22<03:09,  2.57it/s] 11%|█         | 58/545 [00:22<03:08,  2.58it/s] 11%|█         | 59/545 [00:23<03:08,  2.58it/s] 11%|█         | 60/545 [00:23<03:07,  2.59it/s]                                                 11%|█         | 60/545 [00:23<03:07,  2.59it/s] 11%|█         | 61/545 [00:24<03:07,  2.59it/s] 11%|█▏        | 62/545 [00:24<03:06,  2.59it/s] 12%|█▏        | 63/545 [00:24<03:06,  2.59it/s] 12%|█▏        | 64/545 [00:25<03:05,  2.59it/s] 12%|█▏        | 65/545 [00:25<03:05,  2.59it/s] 12%|█▏        | 66/545 [00:25<03:05,  2.58it/s] 12%|█▏        | 67/545 [00:26<03:05,  2.58it/s] 12%|█▏        | 68/545 [00:26<03:05,  2.58it/s] 13%|█▎        | 69/545 [00:27<03:08,  2.53it/s] 13%|█▎        | 70/545 [00:27<03:07,  2.54it/s]                                                 13%|█▎        | 70/545 [00:27<03:07,  2.54it/s] 13%|█▎        | 71/545 [00:27<03:06,  2.54it/s] 13%|█▎        | 72/545 [00:28<03:05,  2.55it/s] 13%|█▎        | 73/545 [00:28<03:05,  2.54it/s] 14%|█▎        | 74/545 [00:29<03:07,  2.51it/s] 14%|█▍        | 75/545 [00:29<03:05,  2.53it/s] 14%|█▍        | 76/545 [00:29<03:03,  2.55it/s] 14%|█▍        | 77/545 [00:30<03:02,  2.56it/s] 14%|█▍        | 78/545 [00:30<03:01,  2.57it/s] 14%|█▍        | 79/545 [00:31<03:01,  2.57it/s] 15%|█▍        | 80/545 [00:31<03:00,  2.58it/s]                                                 15%|█▍        | 80/545 [00:31<03:00,  2.58it/s] 15%|█▍        | 81/545 [00:31<03:00,  2.57it/s] 15%|█▌        | 82/545 [00:32<03:00,  2.57it/s] 15%|█▌        | 83/545 [00:32<02:59,  2.57it/s] 15%|█▌        | 84/545 [00:33<02:59,  2.57it/s] 16%|█▌        | 85/545 [00:33<02:58,  2.57it/s] 16%|█▌        | 86/545 [00:33<02:57,  2.58it/s] 16%|█▌        | 87/545 [00:34<02:57,  2.58it/s] 16%|█▌        | 88/545 [00:34<02:56,  2.58it/s] 16%|█▋        | 89/545 [00:34<02:56,  2.58it/s] 17%|█▋        | 90/545 [00:35<02:58,  2.55it/s]                                                 17%|█▋        | 90/545 [00:35<02:58,  2.55it/s] 17%|█▋        | 91/545 [00:35<02:59,  2.53it/s] 17%|█▋        | 92/545 [00:36<03:00,  2.52it/s] 17%|█▋        | 93/545 [00:36<02:55,  2.57it/s] 17%|█▋        | 94/545 [00:36<02:57,  2.54it/s] 17%|█▋        | 95/545 [00:37<02:58,  2.51it/s] 18%|█▊        | 96/545 [00:37<02:59,  2.51it/s] 18%|█▊        | 97/545 [00:38<02:59,  2.50it/s] 18%|█▊        | 98/545 [00:38<02:59,  2.49it/s] 18%|█▊        | 99/545 [00:38<02:58,  2.50it/s] 18%|█▊        | 100/545 [00:39<02:56,  2.52it/s]                                                  18%|█▊        | 100/545 [00:39<02:56,  2.52it/s] 19%|█▊        | 101/545 [00:39<02:55,  2.52it/s] 19%|█▊        | 102/545 [00:40<02:55,  2.52it/s] 19%|█▉        | 103/545 [00:40<02:56,  2.50it/s] 19%|█▉        | 104/545 [00:40<02:56,  2.50it/s] 19%|█▉        | 105/545 [00:41<02:55,  2.50it/s] 19%|█▉        | 106/545 [00:41<02:55,  2.49it/s] 20%|█▉        | 107/545 [00:42<02:55,  2.50it/s] 20%|█▉        | 108/545 [00:42<02:54,  2.50it/s] 20%|██        | 109/545 [00:42<02:52,  2.53it/s]{'loss': 1.6099, 'grad_norm': 6.90625, 'learning_rate': 1.9669724770642205e-05, 'mean_token_accuracy': 0.7229793220758438, 'epoch': 0.09}
{'loss': 1.2811, 'grad_norm': 8.625, 'learning_rate': 1.9302752293577984e-05, 'mean_token_accuracy': 0.761088079214096, 'epoch': 0.18}
{'loss': 1.1877, 'grad_norm': 12.5625, 'learning_rate': 1.8935779816513762e-05, 'mean_token_accuracy': 0.7632706895470619, 'epoch': 0.28}
{'loss': 1.0928, 'grad_norm': 6.84375, 'learning_rate': 1.8568807339449545e-05, 'mean_token_accuracy': 0.7667172327637672, 'epoch': 0.37}
{'loss': 1.0885, 'grad_norm': 6.15625, 'learning_rate': 1.8201834862385323e-05, 'mean_token_accuracy': 0.7635296285152435, 'epoch': 0.46}
{'loss': 1.0368, 'grad_norm': 5.1875, 'learning_rate': 1.7834862385321102e-05, 'mean_token_accuracy': 0.7687357321381569, 'epoch': 0.55}
{'loss': 1.0194, 'grad_norm': 4.53125, 'learning_rate': 1.7467889908256884e-05, 'mean_token_accuracy': 0.775920620560646, 'epoch': 0.64}
{'loss': 1.0401, 'grad_norm': 4.9375, 'learning_rate': 1.7100917431192663e-05, 'mean_token_accuracy': 0.7701938465237618, 'epoch': 0.73}
{'loss': 0.9718, 'grad_norm': 4.78125, 'learning_rate': 1.6733944954128442e-05, 'mean_token_accuracy': 0.7831847816705704, 'epoch': 0.83}
{'loss': 1.0135, 'grad_norm': 4.40625, 'learning_rate': 1.6366972477064224e-05, 'mean_token_accuracy': 0.7765084192156791, 'epoch': 0.92}

  0%|          | 0/39 [00:00<?, ?it/s][A
 15%|█▌        | 6/39 [00:00<00:00, 53.63it/s][A
 31%|███       | 12/39 [00:00<00:00, 47.77it/s][A
 44%|████▎     | 17/39 [00:00<00:00, 46.48it/s][A
 56%|█████▋    | 22/39 [00:00<00:00, 45.80it/s][A
 69%|██████▉   | 27/39 [00:00<00:00, 45.17it/s][A
 82%|████████▏ | 32/39 [00:00<00:00, 44.97it/s][A
 95%|█████████▍| 37/39 [00:00<00:00, 44.85it/s][A                                                 
                                               [A 20%|██        | 109/545 [00:43<02:52,  2.53it/s]
100%|██████████| 39/39 [00:00<00:00, 44.85it/s][A
                                               [A 20%|██        | 110/545 [00:50<18:43,  2.58s/it]                                                  20%|██        | 110/545 [00:50<18:43,  2.58s/it] 20%|██        | 111/545 [00:51<13:55,  1.93s/it] 21%|██        | 112/545 [00:51<10:34,  1.47s/it] 21%|██        | 113/545 [00:51<08:14,  1.15s/it] 21%|██        | 114/545 [00:52<06:36,  1.09it/s] 21%|██        | 115/545 [00:52<05:27,  1.31it/s] 21%|██▏       | 116/545 [00:52<04:39,  1.54it/s] 21%|██▏       | 117/545 [00:53<04:06,  1.74it/s] 22%|██▏       | 118/545 [00:53<03:43,  1.91it/s] 22%|██▏       | 119/545 [00:54<03:26,  2.07it/s] 22%|██▏       | 120/545 [00:54<03:14,  2.19it/s]                                                  22%|██▏       | 120/545 [00:54<03:14,  2.19it/s] 22%|██▏       | 121/545 [00:54<03:06,  2.27it/s] 22%|██▏       | 122/545 [00:55<03:01,  2.34it/s] 23%|██▎       | 123/545 [00:55<02:57,  2.38it/s] 23%|██▎       | 124/545 [00:56<02:55,  2.40it/s] 23%|██▎       | 125/545 [00:56<02:54,  2.41it/s] 23%|██▎       | 126/545 [00:56<02:52,  2.43it/s] 23%|██▎       | 127/545 [00:57<02:51,  2.44it/s] 23%|██▎       | 128/545 [00:57<02:49,  2.46it/s] 24%|██▎       | 129/545 [00:58<02:47,  2.48it/s] 24%|██▍       | 130/545 [00:58<02:47,  2.47it/s]                                                  24%|██▍       | 130/545 [00:58<02:47,  2.47it/s] 24%|██▍       | 131/545 [00:58<02:47,  2.48it/s] 24%|██▍       | 132/545 [00:59<02:46,  2.48it/s] 24%|██▍       | 133/545 [00:59<02:46,  2.47it/s] 25%|██▍       | 134/545 [01:00<02:46,  2.47it/s] 25%|██▍       | 135/545 [01:00<02:45,  2.47it/s] 25%|██▍       | 136/545 [01:01<02:44,  2.49it/s] 25%|██▌       | 137/545 [01:01<02:44,  2.49it/s] 25%|██▌       | 138/545 [01:01<02:43,  2.49it/s] 26%|██▌       | 139/545 [01:02<02:43,  2.49it/s] 26%|██▌       | 140/545 [01:02<02:42,  2.49it/s]                                                  26%|██▌       | 140/545 [01:02<02:42,  2.49it/s] 26%|██▌       | 141/545 [01:03<02:42,  2.49it/s] 26%|██▌       | 142/545 [01:03<02:42,  2.49it/s] 26%|██▌       | 143/545 [01:03<02:41,  2.49it/s] 26%|██▋       | 144/545 [01:04<02:41,  2.48it/s] 27%|██▋       | 145/545 [01:04<02:41,  2.48it/s] 27%|██▋       | 146/545 [01:05<02:41,  2.47it/s] 27%|██▋       | 147/545 [01:05<02:41,  2.47it/s] 27%|██▋       | 148/545 [01:05<02:40,  2.48it/s] 27%|██▋       | 149/545 [01:06<02:39,  2.48it/s] 28%|██▊       | 150/545 [01:06<02:39,  2.48it/s]                                                  28%|██▊       | 150/545 [01:06<02:39,  2.48it/s] 28%|██▊       | 151/545 [01:07<02:38,  2.48it/s] 28%|██▊       | 152/545 [01:07<02:38,  2.48it/s] 28%|██▊       | 153/545 [01:07<02:33,  2.56it/s] 28%|██▊       | 154/545 [01:08<02:33,  2.55it/s] 28%|██▊       | 155/545 [01:08<02:34,  2.52it/s] 29%|██▊       | 156/545 [01:09<02:34,  2.52it/s] 29%|██▉       | 157/545 [01:09<02:35,  2.50it/s] 29%|██▉       | 158/545 [01:09<02:34,  2.50it/s] 29%|██▉       | 159/545 [01:10<02:34,  2.49it/s] 29%|██▉       | 160/545 [01:10<02:34,  2.49it/s]                                                  29%|██▉       | 160/545 [01:10<02:34,  2.49it/s] 30%|██▉       | 161/545 [01:11<02:34,  2.48it/s] 30%|██▉       | 162/545 [01:11<02:34,  2.48it/s] 30%|██▉       | 163/545 [01:11<02:33,  2.48it/s] 30%|███       | 164/545 [01:12<02:33,  2.48it/s] 30%|███       | 165/545 [01:12<02:32,  2.48it/s] 30%|███       | 166/545 [01:13<02:32,  2.48it/s] 31%|███       | 167/545 [01:13<02:32,  2.48it/s] 31%|███       | 168/545 [01:13<02:32,  2.48it/s] 31%|███       | 169/545 [01:14<02:31,  2.48it/s] 31%|███       | 170/545 [01:14<02:31,  2.47it/s]                                                  31%|███       | 170/545 [01:14<02:31,  2.47it/s] 31%|███▏      | 171/545 [01:15<02:31,  2.47it/s] 32%|███▏      | 172/545 [01:15<02:30,  2.47it/s] 32%|███▏      | 173/545 [01:15<02:30,  2.48it/s] 32%|███▏      | 174/545 [01:16<02:29,  2.49it/s] 32%|███▏      | 175/545 [01:16<02:29,  2.48it/s] 32%|███▏      | 176/545 [01:17<02:29,  2.47it/s] 32%|███▏      | 177/545 [01:17<02:28,  2.48it/s] 33%|███▎      | 178/545 [01:17<02:27,  2.48it/s] 33%|███▎      | 179/545 [01:18<02:27,  2.48it/s] 33%|███▎      | 180/545 [01:18<02:27,  2.48it/s]                                                  33%|███▎      | 180/545 [01:18<02:27,  2.48it/s] 33%|███▎      | 181/545 [01:19<02:26,  2.48it/s] 33%|███▎      | 182/545 [01:19<02:26,  2.48it/s] 34%|███▎      | 183/545 [01:19<02:25,  2.49it/s] 34%|███▍      | 184/545 [01:20<02:25,  2.49it/s] 34%|███▍      | 185/545 [01:20<02:24,  2.49it/s] 34%|███▍      | 186/545 [01:21<02:24,  2.48it/s]run_arc_experiments.sh: line 44: 1789831 Killed                  $PYTHON sft_compare.py --model "$model" --dataset "$dataset" --dataset_config "$dataset_config" --split "$train_split" --eval_split "$eval_split" --method "$method" --out "$output_dir" --max_seq_length $max_seq_len $BF16_FLAG --per_device_train_batch_size $BATCH_SIZE --grad_accum $GRAD_ACCUM --num_train_epochs $NUM_EPOCHS --early_stopping_patience $EARLY_STOPPING_PATIENCE
